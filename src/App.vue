 <template>
  <div class="app-container">
    <!-- Â∑¶‰æßËèúÂçïÊ†è -->
    <div class="sidebar">
      <div class="logo">
        <h2>Âπ≤ÈÉ®ÁÆ°ÁêÜÁ≥ªÁªü</h2>
      </div>
      <nav class="menu">
        <button 
          class="menu-item" 
          :class="{ active: activeTab === 'cadre-list' }"
          @click="activeTab = 'cadre-list'"
        >
          <i class="menu-icon">üìã</i>
          ÁÆ°ÁêÜ‰∫∫Âëò‰ø°ÊÅØË°®
        </button>
        <button 
          class="menu-item" 
          :class="{ active: activeTab === 'statistics' }"
          @click="activeTab = 'statistics'"
        >
          <i class="menu-icon">üìä</i>
          ‰ø°ÊÅØÁªìÊûÑÁªüËÆ°
        </button>
      </nav>
    </div>

    <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
    <div class="main-content">
      <!-- ÁÆ°ÁêÜ‰∫∫Âëò‰ø°ÊÅØË°® -->
      <div v-if="activeTab === 'cadre-list'" class="content-section">
        <div class="section-header">
          <h2>ÁÆ°ÁêÜ‰∫∫Âëò‰ø°ÊÅØË°®</h2>
        </div>
        
        <!-- Á≠õÈÄâÊù°‰ª∂Èù¢Êùø -->
        <div class="filter-panel">
          <div class="filter-header">
            <h3>Á≠õÈÄâÊù°‰ª∂</h3>
            <el-button @click="toggleFilterPanel" size="small" class="toggle-filter-button">
              {{ showFilterPanel ? 'Êî∂Ëµ∑' : 'Â±ïÂºÄ' }}
            </el-button>
          </div>
          <div v-show="showFilterPanel" class="filter-content">
            <el-row :gutter="16">
              <el-col :span="6">
                <el-form-item label="ÂßìÂêç">
                  <el-input v-model="filters.name" placeholder="ËØ∑ËæìÂÖ•ÂßìÂêç" clearable prefix-icon="Search" />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="ÊÄßÂà´">
                  <el-select v-model="filters.gender" placeholder="ËØ∑ÈÄâÊã©" clearable>
                    <el-option label="ÂÖ®ÈÉ®" value="" />
                    <el-option label="Áî∑" value="Áî∑" />
                    <el-option label="Â•≥" value="Â•≥" />
                  </el-select>
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="ÈÉ®Èó®">
                  <el-input v-model="filters.department" placeholder="ËØ∑ËæìÂÖ•ÈÉ®Èó®" clearable :prefix-icon="OfficeBuilding" />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="ÁßëÂÆ§">
                  <el-input v-model="filters.section" placeholder="ËØ∑ËæìÂÖ•ÁßëÂÆ§" clearable :prefix-icon="OfficeBuilding" />
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="6">
                <el-form-item label="ËÅåÂä°1">
                  <el-input v-model="filters.position1" placeholder="ËØ∑ËæìÂÖ•ËÅåÂä°1" clearable prefix-icon="UserFilled" />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="ËÅåÂä°2">
                  <el-input v-model="filters.position2" placeholder="ËØ∑ËæìÂÖ•ËÅåÂä°2" clearable prefix-icon="UserFilled" />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="Â≠¶ÂéÜ">
                  <el-input v-model="filters.education" placeholder="ËØ∑ËæìÂÖ•Â≠¶ÂéÜ" clearable :prefix-icon="Medal" />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="ÊîøÊ≤ªÈù¢Ë≤å">
                  <el-select v-model="filters.politicalStatus" placeholder="ËØ∑ÈÄâÊã©" clearable>
                    <el-option label="ÂÖ®ÈÉ®" value="" />
                    <el-option label="‰∏≠ÂÖ±ÂÖöÂëò" value="‰∏≠ÂÖ±ÂÖöÂëò" />
                    <el-option label="È¢ÑÂ§áÂÖöÂëò" value="È¢ÑÂ§áÂÖöÂëò" />
                    <el-option label="ÂÖ±ÈùíÂõ¢Âëò" value="ÂÖ±ÈùíÂõ¢Âëò" />
                  </el-select>
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="6">
                <el-form-item label="Ë∫´‰ªΩËØÅÂè∑">
                  <el-input v-model="filters.idNumber" placeholder="ËØ∑ËæìÂÖ•Ë∫´‰ªΩËØÅÂè∑" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="Á±çË¥Ø">
                  <el-input v-model="filters.nativePlace" placeholder="ËØ∑ËæìÂÖ•Á±çË¥Ø" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="Ê∞ëÊóè">
                  <el-input v-model="filters.ethnicity" placeholder="ËØ∑ËæìÂÖ•Ê∞ëÊóè" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="6">
                <el-form-item label="‰∏ì‰∏öÊäÄÊúØËÅåÂä°">
                  <el-input v-model="filters.technicalPosition" placeholder="ËØ∑ËæìÂÖ•‰∏ì‰∏öÊäÄÊúØËÅåÂä°" clearable />
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="8">
                <el-form-item label="ËÅîÁ≥ªÁîµËØù">
                  <el-input v-model="filters.phone" placeholder="ËØ∑ËæìÂÖ•ËÅîÁ≥ªÁîµËØù" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="ÂÖ•Âè∏Êó•ÊúüËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.companyEntryDate"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="Âπ¥ÈæÑËåÉÂõ¥">
                  <div class="age-range-container">
                    <el-input-number
                      v-model="filters.ageMin"
                      :min="18"
                      :max="70"
                      placeholder="ÊúÄÂ∞èÂπ¥ÈæÑ"
                      style="width: 45%"
                      controls-position="right"
                    />
                    <span class="age-range-separator">Ëá≥</span>
                    <el-input-number
                      v-model="filters.ageMax"
                      :min="18"
                      :max="70"
                      placeholder="ÊúÄÂ§ßÂπ¥ÈæÑ"
                      style="width: 45%"
                      controls-position="right"
                    />
                    <span class="age-range-unit">Â≤Å</span>
                  </div>
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="8">
                <el-form-item label="Âá∫ÁîüÂú∞">
                  <el-input v-model="filters.birthPlace" placeholder="ËØ∑ËæìÂÖ•Âá∫ÁîüÂú∞" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="ÂÖ®Êó•Âà∂Â≠¶ÂéÜ">
                  <el-input v-model="filters.fullTimeEducation" placeholder="ËØ∑ËæìÂÖ•ÂÖ®Êó•Âà∂Â≠¶ÂéÜ" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="Âú®ËÅåÂ≠¶ÂéÜ">
                  <el-input v-model="filters.partTimeEducation" placeholder="ËØ∑ËæìÂÖ•Âú®ËÅåÂ≠¶ÂéÜ" clearable />
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="8">
                <el-form-item label="Âá∫ÁîüÊó•ÊúüËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.birthDate"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="ÂèÇÂä†Â∑•‰ΩúÊó∂Èó¥ËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.workStart"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="‰ªªÁé∞ËÅåÁ∫ßÊó∂Èó¥ËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.currentLevel"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="8">
                <el-form-item label="‰ªªËÅåÊó∂Èó¥ËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.positionEntry"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="ÂÖ•ÂÖöÊó∂Èó¥ËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.partyEntry"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="ËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜíËåÉÂõ¥">
                  <el-date-picker
                    v-model="filterDateRanges.probationEndReminder"
                    type="daterange"
                    range-separator="Ëá≥"
                    start-placeholder="ÂºÄÂßãÊó•Êúü"
                    end-placeholder="ÁªìÊùüÊó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                    style="width: 100%"
                  />
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="8">
                <el-form-item label="ÂÖ®Êó•Âà∂ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö">
                  <el-input v-model="filters.fullTimeSchoolMajor" placeholder="ËØ∑ËæìÂÖ•ÂÖ®Êó•Âà∂ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="Âú®ËÅåÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö">
                  <el-input v-model="filters.partTimeSchoolPhone" placeholder="ËØ∑ËæìÂÖ•Âú®ËÅåÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö" clearable />
                </el-form-item>
              </el-col>
              <el-col :span="8">
                <el-form-item label="ËØïÁî®ÊúüÔºàÂπ¥Ôºâ">
                  <el-input-number
                    v-model="filters.probationPeriod"
                    :min="0"
                    :max="10"
                    :step="0.1"
                    placeholder="ËØ∑ËæìÂÖ•ËØïÁî®Êúü"
                    style="width: 100%"
                    controls-position="right"
                  />
                </el-form-item>
              </el-col>
            </el-row>
            
            <el-row :gutter="16">
              <el-col :span="24">
                <el-form-item label="Â§áÊ≥®">
                  <el-input v-model="filters.remarks" placeholder="ËØ∑ËæìÂÖ•Â§áÊ≥®" clearable />
                </el-form-item>
              </el-col>
            </el-row>
            
            <div class="filter-actions">
              <el-button type="primary" @click="applyFilters" :icon="Search">Â∫îÁî®Á≠õÈÄâ</el-button>
              <el-button @click="clearFilters" :icon="RefreshRight">Ê∏ÖÁ©∫Á≠õÈÄâ</el-button>
            </div>
          </div>
        </div>
        
        <!-- Êìç‰ΩúÊåâÈíÆÁªÑ -->
        <div class="export-buttons-container">
          <div class="export-buttons-info">
            <span class="export-count-info">
              Â∑≤ÈÄâÊã©: {{ selectedCadres.length }} Êù°ËÆ∞ÂΩï
            </span>
          </div>
          <div class="export-buttons-group">
            <button class="btn-primary" @click="openAddModal">
              <i>‚ûï</i> Êñ∞Â¢û
            </button>
            <button class="btn-export btn-export-selected" @click="exportSelectedCadres">
              <i>üì§</i> ÂØºÂá∫ÈÄâ‰∏≠
            </button>
            <button class="btn-export btn-export-full" @click="exportAllCadres">
              <i>üì§</i> ÂØºÂá∫ÂÖ®ÈÉ®
            </button>
          </div>
        </div>

        <!-- Êï∞ÊçÆË°®Ê†º -->
        <div class="horizontal-table-container">
          <div class="table-header">
            <div class="table-row header-row">
              <div class="table-cell">
                <input 
                  type="checkbox" 
                  v-model="selectAll" 
                  @change="toggleSelectAll" 
                  class="row-checkbox"
                />
              </div>
              <div class="table-cell">Â∫èÂè∑</div>
              <div class="table-cell">ÂßìÂêç</div>
              <div class="table-cell">ÊÄßÂà´</div>
              <div class="table-cell">ÈÉ®Èó®</div>
              <div class="table-cell">ÁßëÂÆ§</div>
              <div class="table-cell">ËÅåÂä°1</div>
              <div class="table-cell">ËÅåÂä°2</div>
              <div class="table-cell">ÂÖ•Âè∏Êó•Êúü</div>
              <div class="table-cell">Âè∏ÈæÑÔºàÂπ¥Ôºâ</div>
              <div class="table-cell">ÂèÇÂä†Â∑•‰ΩúÊó∂Èó¥</div>
              <div class="table-cell">Â∑•ÈæÑ(Âπ¥)</div>
              <div class="table-cell">‰ªªÁé∞ËÅåÁ∫ßÊó∂Èó¥</div>
              <div class="table-cell">‰ªªËÅåÊó∂Èó¥</div>
              <div class="table-cell">ËØïÁî®Êúü</div>
              <div class="table-cell">ËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜí</div>
              <div class="table-cell">Ë∫´‰ªΩËØÅÂè∑</div>
              <div class="table-cell">Âá∫ÁîüÊó•Êúü</div>
              <div class="table-cell">Âπ¥ÈæÑ</div>
              <div class="table-cell">Á±çË¥Ø</div>
              <div class="table-cell">Âá∫ÁîüÂú∞</div>
              <div class="table-cell">Ê∞ëÊóè</div>
              <div class="table-cell">‰∏ì‰∏öÊäÄÊúØËÅåÂä°</div>
              <div class="table-cell">Â≠¶ÂéÜ</div>
              <div class="table-cell">ÂÖ®Êó•Âà∂Â≠¶ÂéÜ</div>
              <div class="table-cell">ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö</div>
              <div class="table-cell">Âú®ËÅåÂ≠¶ÂéÜ</div>
              <div class="table-cell">ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö</div>
              <div class="table-cell">ÊîøÊ≤ªÈù¢Ë≤å</div>
              <div class="table-cell">ÂÖ•ÂÖöÊó∂Èó¥</div>
              <div class="table-cell">ËÅîÁ≥ªÁîµËØù</div>
              <div class="table-cell">Â§áÊ≥®</div>
              <div class="table-cell">Êìç‰Ωú</div>
            </div>
          </div>
          <div class="table-body">
            <div v-for="(cadre, index) in cadreList" :key="cadre.id" class="table-row">
              <div class="table-cell">
                <input 
                  type="checkbox" 
                  :value="cadre" 
                  v-model="selectedCadres" 
                  class="row-checkbox"
                />
              </div>
              <div class="table-cell">{{ index + 1 }}</div>
              <div class="table-cell">{{ cadre.name }}</div>
              <div class="table-cell">{{ cadre.gender }}</div>
              <div class="table-cell">{{ cadre.department }}</div>
              <div class="table-cell">{{ cadre.section }}</div>
              <div class="table-cell">{{ cadre.position1 }}</div>
              <div class="table-cell">{{ cadre.position2 }}</div>
              <div class="table-cell">{{ formatDate(cadre.company_entry_date) }}</div>
              <div class="table-cell">{{ cadre.company_tenure }}</div>
              <div class="table-cell">{{ formatDate(cadre.work_start_date) }}</div>
              <div class="table-cell">{{ cadre.work_tenure }}</div>
              <div class="table-cell">{{ formatDate(cadre.current_level_date) }}</div>
              <div class="table-cell">{{ formatDate(cadre.position_entry_date) }}</div>
              <div class="table-cell">{{ cadre.probation_period }}</div>
              <div class="table-cell">{{ formatDate(cadre.probation_end_reminder) }}</div>
              <div class="table-cell">{{ cadre.id_number }}</div>
              <div class="table-cell">{{ formatDate(cadre.birth_date) }}</div>
              <div class="table-cell">{{ cadre.age }}</div>
              <div class="table-cell">{{ cadre.native_place }}</div>
              <div class="table-cell">{{ cadre.birth_place }}</div>
              <div class="table-cell">{{ cadre.ethnicity }}</div>
              <div class="table-cell">{{ cadre.technical_position }}</div>
              <div class="table-cell">{{ cadre.education }}</div>
              <div class="table-cell">{{ cadre.full_time_education }}</div>
              <div class="table-cell">{{ cadre.full_time_school_major }}</div>
              <div class="table-cell">{{ cadre.part_time_education }}</div>
              <div class="table-cell">{{ cadre.part_time_school_phone }}</div>
              <div class="table-cell">{{ cadre.political_status }}</div>
              <div class="table-cell">{{ formatDate(cadre.party_entry_date) }}</div>
              <div class="table-cell">{{ cadre.phone }}</div>
              <div class="table-cell">{{ cadre.remarks }}</div>
              <div class="table-cell actions-cell">
                <button @click="editCadre(cadre)" class="btn-small">ÁºñËæë</button>
                <button @click="deleteCadre(cadre.id)" class="btn-small btn-danger">Âà†Èô§</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ‰ø°ÊÅØÁªìÊûÑÁªüËÆ° -->
      <div v-if="activeTab === 'statistics'" class="content-section">
        <div class="section-header">
          <h2>‰ø°ÊÅØÁªìÊûÑÁªüËÆ°</h2>
        </div>
        <div class="statistics-content">
          <div class="stat-card">
            <h3>üìä ÊÄª‰∫∫Êï∞ÁªüËÆ°</h3>
            <p class="stat-number">{{ cadreList.length }}</p>
          </div>
          <div class="stat-card">
            <h3>üë®‚Äçüíº ÊåâÊÄßÂà´ÁªüËÆ°</h3>
            <p>Áî∑: {{ cadreList.filter(c => c.gender === 'Áî∑').length }}</p>
            <p>Â•≥: {{ cadreList.filter(c => c.gender === 'Â•≥').length }}</p>
          </div>
          <div class="stat-card">
            <h3>üè¢ ÊåâÈÉ®Èó®ÁªüËÆ°</h3>
            <div v-for="(count, dept) in getDepartmentStats()" :key="dept">
              <p>{{ dept }}: {{ count }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ÂØºÂá∫ÈÖçÁΩÆÂºπÁ™ó -->
    <div v-if="showExportModal" class="modal-overlay" @click="closeExportModal">
      <div class="modal-content" @click.stop>
        <div class="modal-header">
          <h3>ÂØºÂá∫ÈÖçÁΩÆ</h3>
          <button class="modal-close" @click="closeExportModal">√ó</button>
        </div>
        <div class="modal-body">
          <div class="export-config-section">
            <div class="filename-row-container">
              <label for="export-file-name" class="filename-label">Êñá‰ª∂Âêç</label>
              <input 
                id="export-file-name" 
                v-model="exportConfig.fileName" 
                placeholder="ËØ∑ËæìÂÖ•Êñá‰ª∂Âêç" 
                autocomplete="off" 
                class="filename-input"
              />
            </div>
            
                      </div>
          
          <div class="export-config-section">
            <div class="field-section-header">
              <h4>ÈÄâÊã©ÂØºÂá∫Â≠óÊÆµ</h4>
              <div class="field-actions">
                <label class="checkbox-label">
                  <input 
                    type="checkbox" 
                    v-model="exportConfig.selectAllFields" 
                    @change="toggleAllFields"
                    class="checkbox-input"
                  /> ÂÖ®ÈÄâ
                </label>
                <button @click="resetFields" class="btn-reset">ÈáçÁΩÆ</button>
              </div>
            </div>
            <div class="field-selection">
              <div class="field-grid">
                <div 
                  v-for="field in exportFields" 
                  :key="field.key" 
                  class="field-item"
                >
                  <label class="checkbox-label">
                    <input 
                      type="checkbox" 
                      :value="field.key" 
                      v-model="exportConfig.selectedFields" 
                      class="checkbox-input"
                    /> {{ field.label }}
                  </label>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" @click="closeExportModal" class="btn-modal-secondary">ÂèñÊ∂à</button>
            <button type="button" @click="performExport" class="btn-modal-primary">ÂØºÂá∫</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Êñ∞Â¢û/ÁºñËæëÂºπÁ™ó -->
    <div v-if="showModal" class="modal-overlay" @click="closeModal">
      <div class="modal-content" @click.stop>
        <div class="modal-header">
          <h3>{{ currentCadre.id ? 'ÁºñËæëÂπ≤ÈÉ®‰ø°ÊÅØ' : 'Êñ∞Â¢ûÂπ≤ÈÉ®‰ø°ÊÅØ' }}</h3>
          <button class="modal-close" @click="closeModal">√ó</button>
        </div>
        <div class="modal-body">
          <el-form 
            ref="cadreFormRef"
            :model="currentCadre"
            :rules="formRules"
            label-width="120px"
            size="default"
            @submit.prevent="saveCadreInfo"
          >
            <!-- Âü∫Êú¨‰ø°ÊÅØ -->
            <div class="form-section">
              <h4 class="form-section-title">Âü∫Êú¨‰ø°ÊÅØ</h4>
              <el-row :gutter="20">
                <el-col :span="8">
                  <el-form-item label="ÂßìÂêç *" prop="name">
                    <el-input v-model="currentCadre.name" placeholder="ËØ∑ËæìÂÖ•ÂßìÂêç" clearable />
                  </el-form-item>
                </el-col>
                <el-col :span="8">
                  <el-form-item label="ÊÄßÂà´" prop="gender">
                    <el-select v-model="currentCadre.gender" placeholder="ËØ∑ÈÄâÊã©ÊÄßÂà´" clearable>
                      <el-option label="" value="" />
                      <el-option label="Áî∑" value="Áî∑" />
                      <el-option label="Â•≥" value="Â•≥" />
                    </el-select>
                  </el-form-item>
                </el-col>
                <el-col :span="8">
                  <el-form-item label="Ë∫´‰ªΩËØÅÂè∑" prop="id_number">
                    <el-input v-model="currentCadre.id_number" @change="extractIdInfo" placeholder="ËØ∑ËæìÂÖ•18‰ΩçË∫´‰ªΩËØÅÂè∑" clearable />
                  </el-form-item>
                </el-col>
              </el-row>
              
              <el-row :gutter="20">
                <el-col :span="8">
                  <el-form-item label="Âá∫ÁîüÊó•Êúü">
                    <el-date-picker 
                      v-model="currentCadre.birth_date" 
                      type="date"
                      placeholder="Ëá™Âä®ËÆ°ÁÆó"
                      format="YYYY-MM-DD"
                      value-format="YYYY-MM-DD"
                      disabled
                      clearable
                    />
                  </el-form-item>
                </el-col>
                <el-col :span="8">
                  <el-form-item label="Âπ¥ÈæÑ">
                    <el-input v-model="currentCadre.age" readonly placeholder="Ëá™Âä®ËÆ°ÁÆó" disabled />
                  </el-form-item>
                </el-col>
                <el-col :span="8">
                  <el-form-item label="Ê∞ëÊóè" prop="ethnicity">
                    <el-select v-model="currentCadre.ethnicity" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•Ê∞ëÊóè" filterable allow-create default-first-option clearable>
                      <el-option v-for="option in ethnicityOptions" :key="option" :label="option" :value="option" />
                    </el-select>
                  </el-form-item>
                </el-col>
              </el-row>
              
              <el-row :gutter="20">
                <el-col :span="8">
                  <el-form-item label="Á±çË¥Ø" prop="native_place">
                    <el-input v-model="currentCadre.native_place" placeholder="ËØ∑ËæìÂÖ•Á±çË¥Ø" clearable />
                  </el-form-item>
                </el-col>
                <el-col :span="8">
                  <el-form-item label="Âá∫ÁîüÂú∞" prop="birth_place">
                    <el-input v-model="currentCadre.birth_place" placeholder="ËØ∑ËæìÂÖ•Âá∫ÁîüÂú∞" clearable />
                  </el-form-item>
                </el-col>
                <el-col :span="8">
                  <el-form-item label="ËÅîÁ≥ªÁîµËØù" prop="phone">
                    <el-input v-model="currentCadre.phone" placeholder="ËØ∑ËæìÂÖ•ËÅîÁ≥ªÁîµËØù" clearable />
                  </el-form-item>
                </el-col>
              </el-row>
            </div>
            
            <!-- Â∑•‰Ωú‰ø°ÊÅØ -->
            <div class="form-section">
              <h4 class="form-section-title">Â∑•‰Ωú‰ø°ÊÅØ</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-department">ÈÉ®Èó®</label>
                  <el-select id="modal-department" v-model="currentCadre.department" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•ÈÉ®Èó®ÂêçÁß∞" filterable allow-create default-first-option clearable>
                    <el-option v-for="option in departmentOptions" :key="option" :label="option" :value="option" />
                  </el-select>
                </div>
                <div class="form-group">
                  <label for="modal-section">ÁßëÂÆ§</label>
                  <el-input id="modal-section" v-model="currentCadre.section" placeholder="ËØ∑ËæìÂÖ•ÁßëÂÆ§ÂêçÁß∞" clearable />
                </div>
                <div class="form-group">
                  <label for="modal-position1">ËÅåÂä°1</label>
                  <el-select id="modal-position1" v-model="currentCadre.position1" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•ËÅåÂä°" filterable allow-create default-first-option clearable>
                    <el-option v-for="option in positionOptions" :key="option" :label="option" :value="option" />
                  </el-select>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-position2">ËÅåÂä°2</label>
                  <el-input id="modal-position2" v-model="currentCadre.position2" placeholder="ËØ∑ËæìÂÖ•ËÅåÂä°2" clearable />
                </div>
                <div class="form-group">
                  <label for="modal-companyEntryDate">ÂÖ•Âè∏Êó•Êúü</label>
                  <el-date-picker 
                    id="modal-companyEntryDate"
                    v-model="currentCadre.company_entry_date" 
                    type="date"
                    placeholder="ËØ∑ÈÄâÊã©Êó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    @change="calculateCompanyTenure"
                    clearable
                  />
                </div>
                <div class="form-group">
                  <label for="modal-companyTenure">Âè∏ÈæÑÔºàÂπ¥Ôºâ</label>
                  <el-input id="modal-companyTenure" v-model="currentCadre.company_tenure" placeholder="Ëá™Âä®ËÆ°ÁÆó" disabled />
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-workStartDate">ÂèÇÂä†Â∑•‰ΩúÊó∂Èó¥</label>
                  <el-date-picker 
                    id="modal-workStartDate"
                    v-model="currentCadre.work_start_date" 
                    type="date"
                    placeholder="ËØ∑ÈÄâÊã©Êó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    @change="calculateWorkTenure"
                    clearable
                  />
                </div>
                <div class="form-group">
                  <label for="modal-workTenure">Â∑•ÈæÑÔºàÂπ¥Ôºâ</label>
                  <el-input id="modal-workTenure" v-model="currentCadre.work_tenure" placeholder="Ëá™Âä®ËÆ°ÁÆó" disabled />
                </div>
                <div class="form-group">
                  <label for="modal-currentLevelDate">‰ªªÁé∞ËÅåÁ∫ßÊó∂Èó¥</label>
                  <el-date-picker 
                    id="modal-currentLevelDate"
                    v-model="currentCadre.current_level_date" 
                    type="date"
                    placeholder="ËØ∑ÈÄâÊã©Êó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                  />
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-positionEntryDate">‰ªªËÅåÊó∂Èó¥</label>
                  <el-date-picker 
                    id="modal-positionEntryDate"
                    v-model="currentCadre.position_entry_date" 
                    type="date"
                    placeholder="ËØ∑ÈÄâÊã©Êó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    @change="calculateProbationEnd"
                    clearable
                  />
                </div>
                <div class="form-group">
                  <label for="modal-probationPeriod">ËØïÁî®ÊúüÔºàÂπ¥Ôºâ</label>
                  <el-input-number id="modal-probationPeriod" v-model="currentCadre.probation_period" :min="0" :max="10" :step="0.1" @change="calculateProbationEnd" placeholder="ËØ∑ËæìÂÖ•ËØïÁî®Êúü" />
                </div>
                <div class="form-group">
                  <label for="modal-probationEndReminder">ËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜí</label>
                  <el-date-picker 
                    id="modal-probationEndReminder"
                    v-model="currentCadre.probation_end_reminder" 
                    type="date"
                    placeholder="Ëá™Âä®ËÆ°ÁÆó"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    disabled
                    clearable
                  />
                </div>
              </div>
            </div>
            
            <!-- ÊïôËÇ≤ËÉåÊôØ -->
            <div class="form-section">
              <h4 class="form-section-title">ÊïôËÇ≤ËÉåÊôØ</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-education">ÊúÄÈ´òÂ≠¶ÂéÜ</label>
                  <el-select id="modal-education" v-model="currentCadre.education" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•Â≠¶ÂéÜ" filterable allow-create default-first-option clearable>
                    <el-option v-for="option in educationOptions" :key="option" :label="option" :value="option" />
                  </el-select>
                </div>
                <div class="form-group">
                  <label for="modal-fullTimeEducation">ÂÖ®Êó•Âà∂Â≠¶ÂéÜ</label>
                  <el-select id="modal-fullTimeEducation" v-model="currentCadre.full_time_education" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•Â≠¶ÂéÜ" filterable allow-create default-first-option clearable>
                    <el-option v-for="option in educationOptions" :key="option" :label="option" :value="option" />
                  </el-select>
                </div>
                <div class="form-group">
                  <label for="modal-fullTimeSchoolMajor">ÂÖ®Êó•Âà∂ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö</label>
                  <el-input id="modal-fullTimeSchoolMajor" v-model="currentCadre.full_time_school_major" placeholder="ËØ∑ËæìÂÖ•ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö" clearable />
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-partTimeEducation">Âú®ËÅåÂ≠¶ÂéÜ</label>
                  <el-select id="modal-partTimeEducation" v-model="currentCadre.part_time_education" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•Â≠¶ÂéÜ" filterable allow-create default-first-option clearable>
                    <el-option v-for="option in educationOptions" :key="option" :label="option" :value="option" />
                  </el-select>
                </div>
                <div class="form-group">
                  <label for="modal-partTimeSchoolPhone">Âú®ËÅåÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö</label>
                  <el-input id="modal-partTimeSchoolPhone" v-model="currentCadre.part_time_school_phone" placeholder="ËØ∑ËæìÂÖ•Âú®ËÅåÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö" clearable />
                </div>
                <div class="form-group">
                  <label for="modal-technicalPosition">‰∏ì‰∏öÊäÄÊúØËÅåÂä°</label>
                  <el-select id="modal-technicalPosition" v-model="currentCadre.technical_position" placeholder="ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•‰∏ì‰∏öÊäÄÊúØËÅåÂä°" filterable allow-create default-first-option clearable>
                    <el-option v-for="option in technicalPositionOptions" :key="option" :label="option" :value="option" />
                  </el-select>
                </div>
              </div>
            </div>
            
            <!-- ÊîøÊ≤ªÈù¢Ë≤å -->
            <div class="form-section">
              <h4 class="form-section-title">ÊîøÊ≤ªÈù¢Ë≤å</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="modal-politicalStatus">ÊîøÊ≤ªÈù¢Ë≤å</label>
                  <el-select id="modal-politicalStatus" v-model="currentCadre.political_status" placeholder="ËØ∑ÈÄâÊã©ÊîøÊ≤ªÈù¢Ë≤å" clearable>
                    <el-option label="" value="" />
                    <el-option label="‰∏≠ÂÖ±ÂÖöÂëò" value="‰∏≠ÂÖ±ÂÖöÂëò" />
                    <el-option label="È¢ÑÂ§áÂÖöÂëò" value="È¢ÑÂ§áÂÖöÂëò" />
                    <el-option label="ÂÖ±ÈùíÂõ¢Âëò" value="ÂÖ±ÈùíÂõ¢Âëò" />
                    <el-option label="Ê∞ëÈù©ÂÖöÂëò" value="Ê∞ëÈù©ÂÖöÂëò" />
                    <el-option label="Ê∞ëÁõüÁõüÂëò" value="Ê∞ëÁõüÁõüÂëò" />
                    <el-option label="Ê∞ëÂª∫‰ºöÂëò" value="Ê∞ëÂª∫‰ºöÂëò" />
                    <el-option label="Ê∞ëËøõ‰ºöÂëò" value="Ê∞ëËøõ‰ºöÂëò" />
                    <el-option label="ÂÜúÂ∑•ÂÖöÂÖöÂëò" value="ÂÜúÂ∑•ÂÖöÂÖöÂëò" />
                    <el-option label="Ëá¥ÂÖ¨ÂÖöÂÖöÂëò" value="Ëá¥ÂÖ¨ÂÖöÂÖöÂëò" />
                    <el-option label="‰πù‰∏âÂ≠¶Á§æÁ§æÂëò" value="‰πù‰∏âÂ≠¶Á§æÁ§æÂëò" />
                    <el-option label="Âè∞ÁõüÁõüÂëò" value="Âè∞ÁõüÁõüÂëò" />
                    <el-option label="Êó†ÂÖöÊ¥æ‰∫∫Â£´" value="Êó†ÂÖöÊ¥æ‰∫∫Â£´" />
                    <el-option label="Áæ§‰ºó" value="Áæ§‰ºó" />
                  </el-select>
                </div>
                <div class="form-group">
                  <label for="modal-partyEntryDate">ÂÖ•ÂÖöÊó∂Èó¥</label>
                  <el-date-picker 
                    id="modal-partyEntryDate"
                    v-model="currentCadre.party_entry_date" 
                    type="date"
                    placeholder="ËØ∑ÈÄâÊã©Êó•Êúü"
                    format="YYYY-MM-DD"
                    value-format="YYYY-MM-DD"
                    clearable
                  />
                </div>
                <div class="form-group full-width">
                  <label for="modal-remarks">Â§áÊ≥®</label>
                  <el-input id="modal-remarks" v-model="currentCadre.remarks" type="textarea" :rows="4" placeholder="ËØ∑ËæìÂÖ•Â§áÊ≥®" clearable />
                </div>
              </div>
            </div>
            
            <div class="form-actions">
              <el-button type="button" @click="closeModal">ÂèñÊ∂à</el-button>
              <el-button type="primary" @click="saveCadreInfo">‰øùÂ≠ò</el-button>
            </div>
          </el-form>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, computed, watch } from "vue";
import { invoke } from "@tauri-apps/api/core";
import { Search, RefreshRight, OfficeBuilding, UserFilled, Medal } from '@element-plus/icons-vue';

// Êó•ÊúüÊ†ºÂºèÂåñËæÖÂä©ÂáΩÊï∞
function formatDate(date) {
  if (!date) return "";
  
  // Â¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂ∞ùËØïËΩ¨Êç¢‰∏∫Êó•ÊúüÂØπË±°
  const dateObj = typeof date === 'string' ? new Date(date) : date;
  
  // Ê£ÄÊü•ÊòØÂê¶ÊòØÊúâÊïàÊó•Êúü
  if (!(dateObj instanceof Date) || isNaN(dateObj.getTime())) {
    return "";
  }
  
  const year = dateObj.getFullYear();
  const month = String(dateObj.getMonth() + 1).padStart(2, '0');
  const day = String(dateObj.getDate()).padStart(2, '0');
  
  return `${year}-${month}-${day}`;
}

const activeTab = ref('cadre-list');
const showModal = ref(false);
const showExportModal = ref(false);
const selectedCadres = ref([]); // Áî®‰∫éÂ≠òÂÇ®ÈÄâ‰∏≠ÁöÑÂπ≤ÈÉ®
const selectAll = ref(false); // Áî®‰∫éÂÖ®ÈÄâÂäüËÉΩ
const cadreFormRef = ref(null); // Ë°®ÂçïÂºïÁî®

// Â≠¶ÂéÜÈÄâÈ°π
const educationOptions = [
  "ÂçöÂ£´Á†îÁ©∂Áîü",
  "Á°ïÂ£´Á†îÁ©∂Áîü",
  "Â§ßÂ≠¶",
  "Â§ß‰∏ì",
  "È´ò‰∏≠",
  "‰∏≠‰∏ì",
  "Âàù‰∏≠",
  "ËÅåÈ´ò"
];

// ‰∏ì‰∏öÊäÄÊúØËÅåÂä°ÈÄâÈ°π
const technicalPositionOptions = [
  "Âä©ÁêÜÊîøÂ∑•Â∏à",
  "ÊîøÂ∑•Â∏à",
  "È´òÁ∫ßÂ∑•Á®ãÂ∏à",
  "‰∏≠Á∫ßÂ∑•Á®ãÂ∏à",
  "Â∑•Á®ãÂ∏à",
  "‰∏≠Á∫ß‰ºöËÆ°Â∏à",
  "Âä©ÁêÜÂ∑•Á®ãÂ∏à",
  "ÂàùÁ∫ß‰ºöËÆ°Â∏à",
  "ÂàùÁ∫ßÁªèÊµéÂ∏à"
];

// ÈÉ®Èó®ÈÄâÈ°π
const departmentOptions = [
  "ÂÖöÂßîÂ∑•‰ΩúÈÉ®ÔºàÊñáÂåñÂÆ£‰º†ÈÉ®Ôºâ",
  "‰∫∫ÂäõËµÑÊ∫êÈÉ®",
  "Ë¥¢Âä°ÈÉ®",
  "Á∫™Ê£ÄÁõëÂØüÈÉ®",
  "Áîü‰∫ßÊäÄÊúØÈÉ®",
  "ÂÆâÂÖ®ÁÆ°ÁêÜÈÉ®",
  "ÁªèËê•ÁÆ°ÁêÜÈÉ®",
  "ÊãõÊ†áÈááË¥≠ÈÉ®",
  "Ë∞ÉÂ∫¶ÊåáÊå•‰∏≠ÂøÉ",
  "Á´ôÂä°‰∏≠ÂøÉ",
  "ËΩ¶ËæÜ‰∏≠ÂøÉ",
  "Áª¥‰øÆ‰∏≠ÂøÉ",
  "Â∑•‰ºöÔºàÂõ¢ÂßîÔºâ",
  "ÂäûÂÖ¨ÂÆ§",
  "È°πÁõÆÁÆ°ÁêÜÈÉ®",
];

// ËÅåÂä°ÈÄâÈ°π
const positionOptions = [
  "‰∏ª‰ªª",
  "ÂâØ‰∏ª‰ªª",
  "Âå∫ÂüüÁ´ôÈïø",
  "Âå∫ÂüüÂâØÁ´ôÈïø",
  "ÈÉ®Èïø",
  "ÂâØÈÉ®Èïø",
  "ÈÉ®ÈïøÂä©ÁêÜ",
  "ÁªèÁêÜ",
  "ÂâØÁªèÁêÜ",
  "ÁªèÁêÜÂä©ÁêÜ"
];

// Ê∞ëÊóèÈÄâÈ°π
const ethnicityOptions = [
  "Ê±âÊóè",
  "Áï≤Êóè",
  "‰æóÊóè",
  "Áë∂Êóè"
];

// Ë°®ÂçïÈ™åËØÅËßÑÂàô
const formRules = {
  name: [
    { required: true, message: 'ËØ∑ËæìÂÖ•ÂßìÂêç', trigger: 'blur' },
    { min: 2, max: 20, message: 'ÂßìÂêçÈïøÂ∫¶Âú® 2 Âà∞ 20 ‰∏™Â≠óÁ¨¶', trigger: 'blur' }
  ],
  gender: [
    { required: true, message: 'ËØ∑ÈÄâÊã©ÊÄßÂà´', trigger: 'change' }
  ],
  id_number: [
    { pattern: /^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/, message: 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑ18‰ΩçË∫´‰ªΩËØÅÂè∑', trigger: 'blur' }
  ],
  department: [
    { required: true, message: 'ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•ÈÉ®Èó®', trigger: 'change' }
  ],
  section: [
    { required: true, message: 'ËØ∑ËæìÂÖ•ÁßëÂÆ§', trigger: 'blur' }
  ],
  position1: [
    { required: true, message: 'ËØ∑ÈÄâÊã©ÊàñËæìÂÖ•ËÅåÂä°1', trigger: 'change' }
  ],
  phone: [
    { pattern: /^1[3-9]\d{9}$/, message: 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÊâãÊú∫Âè∑Á†Å', trigger: 'blur' }
  ]
};

// ÊâÄÊúâÂèØÂØºÂá∫Â≠óÊÆµÁöÑÈÖçÁΩÆ
const exportFields = [
  { key: "name", label: "ÂßìÂêç" },
  { key: "gender", label: "ÊÄßÂà´" },
  { key: "department", label: "ÈÉ®Èó®" },
  { key: "section", label: "ÁßëÂÆ§" },
  { key: "position1", label: "ËÅåÂä°1" },
  { key: "position2", label: "ËÅåÂä°2" },
  { key: "company_entry_date", label: "ÂÖ•Âè∏Êó•Êúü" },
  { key: "company_tenure", label: "Âè∏ÈæÑÔºàÂπ¥Ôºâ" },
  { key: "work_start_date", label: "ÂèÇÂä†Â∑•‰ΩúÊó∂Èó¥" },
  { key: "work_tenure", label: "Â∑•ÈæÑ(Âπ¥)" },
  { key: "current_level_date", label: "‰ªªÁé∞ËÅåÁ∫ßÊó∂Èó¥" },
  { key: "position_entry_date", label: "‰ªªËÅåÊó∂Èó¥" },
  { key: "probation_period", label: "ËØïÁî®Êúü" },
  { key: "probation_end_reminder", label: "ËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜí" },
  { key: "id_number", label: "Ë∫´‰ªΩËØÅÂè∑" },
  { key: "birth_date", label: "Âá∫ÁîüÊó•Êúü" },
  { key: "age", label: "Âπ¥ÈæÑ" },
  { key: "native_place", label: "Á±çË¥Ø" },
  { key: "birth_place", label: "Âá∫ÁîüÂú∞" },
  { key: "ethnicity", label: "Ê∞ëÊóè" },
  { key: "technical_position", label: "‰∏ì‰∏öÊäÄÊúØËÅåÂä°" },
  { key: "education", label: "Â≠¶ÂéÜ" },
  { key: "full_time_education", label: "ÂÖ®Êó•Âà∂Â≠¶ÂéÜ" },
  { key: "full_time_school_major", label: "ÂÖ®Êó•Âà∂ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö" },
  { key: "part_time_education", label: "Âú®ËÅåÂ≠¶ÂéÜ" },
  { key: "part_time_school_phone", label: "Âú®ËÅåÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏ö" },
  { key: "political_status", label: "ÊîøÊ≤ªÈù¢Ë≤å" },
  { key: "party_entry_date", label: "ÂÖ•ÂÖöÊó∂Èó¥" },
  { key: "phone", label: "ËÅîÁ≥ªÁîµËØù" },
  { key: "remarks", label: "Â§áÊ≥®" }
];

// ÂØºÂá∫ÈÖçÁΩÆ
const exportConfig = ref({
  fileName: "Âπ≤ÈÉ®‰ø°ÊÅØ",
  selectedFields: [], // ÈÄâ‰∏≠ÁöÑÂ≠óÊÆµ
  selectAllFields: false
});

// ÂàùÂßãÂåñÂØºÂá∫Â≠óÊÆµÔºàÈªòËÆ§ÂÖ®ÈÄâÔºâ
exportConfig.value.selectedFields = exportFields.map(field => field.key);

const currentCadre = ref({
  id: null,
  name: "",
  gender: "",
  department: "",
  section: "",
  position1: "",
  position2: "",
  company_entry_date: "",
  company_tenure: null,
  work_start_date: "",
  work_tenure: null,
  current_level_date: "",
  position_entry_date: "",
  probation_period: "",
  probation_end_reminder: "",
  id_number: "",
  birth_date: "",
  age: null,
  native_place: "",
  birth_place: "",
  ethnicity: "",
  technical_position: "",
  education: "",
  full_time_education: "",
  full_time_school_major: "",
  part_time_education: "",
  part_time_school_phone: "",
  political_status: "",
  party_entry_date: "",
  phone: "",
  remarks: "",
  major: "",
  contact_date: "",
  special_date: ""
});

const cadreList = ref([]);
const showFilterPanel = ref(false);
const filterDateRanges = ref({
  companyEntryDate: [],
  birthDate: [],
  workStart: [],
  currentLevel: [],
  positionEntry: [],
  partyEntry: [],
  probationEndReminder: []
});
const filters = ref({
  name: "",
  gender: "",
  department: "",
  section: "",
  position1: "",
  position2: "",
  education: "",
  politicalStatus: "",
  idNumber: "",
  nativePlace: "",
  ethnicity: "",
  technicalPosition: "",
  phone: "",
  ageMin: "",
  ageMax: "",
  birthPlace: "",
  fullTimeEducation: "",
  partTimeEducation: "",
  probationPeriod: "",
  fullTimeSchoolMajor: "",
  partTimeSchoolPhone: "",
  remarks: ""
});

// ËÆ°ÁÆóÁ≠õÈÄâÂêéÁöÑÂπ≤ÈÉ®ÂàóË°®
const filteredCadreList = computed(() => {
  return cadreList.value.filter(cadre => {
    // ÂßìÂêçÁ≠õÈÄâ
    if (filters.value.name && !cadre.name.includes(filters.value.name)) {
      return false;
    }
    
    // ÊÄßÂà´Á≠õÈÄâ
    if (filters.value.gender && cadre.gender !== filters.value.gender) {
      return false;
    }
    
    // ÈÉ®Èó®Á≠õÈÄâ
    if (filters.value.department && !cadre.department.includes(filters.value.department)) {
      return false;
    }
    
    // ÁßëÂÆ§Á≠õÈÄâ
    if (filters.value.section && !cadre.section.includes(filters.value.section)) {
      return false;
    }
    
    // ËÅåÂä°1Á≠õÈÄâ
    if (filters.value.position1 && !cadre.position1.includes(filters.value.position1)) {
      return false;
    }
    
    // ËÅåÂä°2Á≠õÈÄâ
    if (filters.value.position2 && !cadre.position2.includes(filters.value.position2)) {
      return false;
    }
    
    // Â≠¶ÂéÜÁ≠õÈÄâ
    if (filters.value.education && !cadre.education.includes(filters.value.education)) {
      return false;
    }
    
    // ÊîøÊ≤ªÈù¢Ë≤åÁ≠õÈÄâ
    if (filters.value.politicalStatus && cadre.political_status !== filters.value.politicalStatus) {
      return false;
    }
    
    // Ë∫´‰ªΩËØÅÂè∑Á≠õÈÄâ
    if (filters.value.idNumber && !cadre.id_number.includes(filters.value.idNumber)) {
      return false;
    }
    
    // Á±çË¥ØÁ≠õÈÄâ
    if (filters.value.nativePlace && !cadre.native_place.includes(filters.value.nativePlace)) {
      return false;
    }
    
    // Ê∞ëÊóèÁ≠õÈÄâ
    if (filters.value.ethnicity && !cadre.ethnicity.includes(filters.value.ethnicity)) {
      return false;
    }
    
    // ‰∏ì‰∏öÊäÄÊúØËÅåÂä°Á≠õÈÄâ
    if (filters.value.technicalPosition && !cadre.technical_position.includes(filters.value.technicalPosition)) {
      return false;
    }
    
    // ËÅîÁ≥ªÁîµËØùÁ≠õÈÄâ
    if (filters.value.phone && !cadre.phone.includes(filters.value.phone)) {
      return false;
    }
    
    // ÂÖ•Âè∏Êó•ÊúüËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.companyEntryDate && filterDateRanges.value.companyEntryDate.length === 2) {
      const entryDate = new Date(cadre.company_entry_date);
      const [startDate, endDate] = filterDateRanges.value.companyEntryDate.map(date => new Date(date));
      
      if (entryDate < startDate) {
        return false;
      }
      
      if (entryDate > endDate) {
        return false;
      }
    }
    
      // Âπ¥ÈæÑËåÉÂõ¥Á≠õÈÄâ
    if (filters.value.ageMin || filters.value.ageMax || filters.value.ageRange) {
      const age = parseInt(cadre.age);
      
      if (filters.value.ageMin && age < parseInt(filters.value.ageMin)) {
        return false;
      }
      
      if (filters.value.ageMax && age > parseInt(filters.value.ageMax)) {
        return false;
      }
      
      // ÈÄöËøáËåÉÂõ¥ÊªëÂùóÊõ¥Êñ∞Âπ¥ÈæÑËåÉÂõ¥
      if (filters.value.ageRange && !filters.value.ageMin && !filters.value.ageMax) {
        const range = parseInt(filters.value.ageRange);
        // ÁÆÄÂçïÁöÑÈÄªËæëÔºöËåÉÂõ¥ÂÄº‰Ωú‰∏∫ÊúÄÂ§ßÂÄºÔºåÊúÄÂ∞èÂÄºËÆæ‰∏∫ËåÉÂõ¥-10
        if (age > range || age < range - 10) {
          return false;
        }
      }
    }
    
    // Âá∫ÁîüÂú∞Á≠õÈÄâ
    if (filters.value.birthPlace && !cadre.birth_place.includes(filters.value.birthPlace)) {
      return false;
    }
    
    // ÂÖ®Êó•Âà∂Â≠¶ÂéÜÁ≠õÈÄâ
    if (filters.value.fullTimeEducation && !cadre.full_time_education.includes(filters.value.fullTimeEducation)) {
      return false;
    }
    
    // Âú®ËÅåÂ≠¶ÂéÜÁ≠õÈÄâ
    if (filters.value.partTimeEducation && !cadre.part_time_education.includes(filters.value.partTimeEducation)) {
      return false;
    }
    
    // Âá∫ÁîüÊó•ÊúüËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.birthDate && filterDateRanges.value.birthDate.length === 2) {
      const birthDate = new Date(cadre.birth_date);
      const [startDate, endDate] = filterDateRanges.value.birthDate.map(date => new Date(date));
      
      if (birthDate < startDate) {
        return false;
      }
      
      if (birthDate > endDate) {
        return false;
      }
    }
    
    // ÂèÇÂä†Â∑•‰ΩúÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.workStart && filterDateRanges.value.workStart.length === 2) {
      const workDate = new Date(cadre.work_start_date);
      const [startDate, endDate] = filterDateRanges.value.workStart.map(date => new Date(date));
      
      if (workDate < startDate) {
        return false;
      }
      
      if (workDate > endDate) {
        return false;
      }
    }
    
    // ‰ªªÁé∞ËÅåÁ∫ßÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.currentLevel && filterDateRanges.value.currentLevel.length === 2) {
      const currentDate = new Date(cadre.current_level_date);
      const [startDate, endDate] = filterDateRanges.value.currentLevel.map(date => new Date(date));
      
      if (currentDate < startDate) {
        return false;
      }
      
      if (currentDate > endDate) {
        return false;
      }
    }
    
    // ‰ªªËÅåÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.positionEntry && filterDateRanges.value.positionEntry.length === 2) {
      const positionDate = new Date(cadre.position_entry_date);
      const [startDate, endDate] = filterDateRanges.value.positionEntry.map(date => new Date(date));
      
      if (positionDate < startDate) {
        return false;
      }
      
      if (positionDate > endDate) {
        return false;
      }
    }
    
    // ÂÖ•ÂÖöÊó∂Èó¥ËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.partyEntry && filterDateRanges.value.partyEntry.length === 2) {
      const partyDate = new Date(cadre.party_entry_date);
      const [startDate, endDate] = filterDateRanges.value.partyEntry.map(date => new Date(date));
      
      if (partyDate < startDate) {
        return false;
      }
      
      if (partyDate > endDate) {
        return false;
      }
    }
    
    // ËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜíËåÉÂõ¥Á≠õÈÄâ
    if (filterDateRanges.value.probationEndReminder && filterDateRanges.value.probationEndReminder.length === 2) {
      const reminderDate = new Date(cadre.probation_end_reminder);
      const [startDate, endDate] = filterDateRanges.value.probationEndReminder.map(date => new Date(date));
      
      if (reminderDate < startDate) {
        return false;
      }
      
      if (reminderDate > endDate) {
        return false;
      }
    }
    
    // ÂÖ®Êó•Âà∂ÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏öÁ≠õÈÄâ
    if (filters.value.fullTimeSchoolMajor && !cadre.full_time_school_major.includes(filters.value.fullTimeSchoolMajor)) {
      return false;
    }
    
    // Âú®ËÅåÊØï‰∏öÈô¢Ê†°Á≥ªÂèä‰∏ì‰∏öÁ≠õÈÄâ
    if (filters.value.partTimeSchoolPhone && !cadre.part_time_school_phone.includes(filters.value.partTimeSchoolPhone)) {
      return false;
    }
    
    // ËØïÁî®ÊúüÁ≠õÈÄâ
    if (filters.value.probationPeriod && cadre.probation_period !== parseFloat(filters.value.probationPeriod)) {
      return false;
    }
    
    // Â§áÊ≥®Á≠õÈÄâ
    if (filters.value.remarks && !cadre.remarks.includes(filters.value.remarks)) {
      return false;
    }
    
    return true;
  });
});

// Âä†ËΩΩÊâÄÊúâÂπ≤ÈÉ®‰ø°ÊÅØ
async function loadCadreInfo() {
  try {
    cadreList.value = await invoke("get_all_cadre_info");
  } catch (error) {
    console.error("Âä†ËΩΩÂπ≤ÈÉ®‰ø°ÊÅØÂ§±Ë¥•:", error);
  }
}

// ‰øùÂ≠òÂπ≤ÈÉ®‰ø°ÊÅØ
async function saveCadreInfo() {
  try {
    // Ë°®ÂçïÈ™åËØÅ
    await cadreFormRef.value.validate();
    
    // ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÂØπË±°Áî®‰∫é‰øùÂ≠òÔºåÁ°Æ‰øùÊó•ÊúüÂ≠óÊÆµË¢´Ê≠£Á°ÆÊ†ºÂºèÂåñ
    const cadreToSave = { ...currentCadre.value };
    
    // Ê†ºÂºèÂåñÊâÄÊúâÊó•ÊúüÂ≠óÊÆµ‰∏∫Â≠óÁ¨¶‰∏≤
    if (cadreToSave.company_entry_date) {
      cadreToSave.company_entry_date = formatDate(cadreToSave.company_entry_date);
    }
    
    if (cadreToSave.work_start_date) {
      cadreToSave.work_start_date = formatDate(cadreToSave.work_start_date);
    }
    
    if (cadreToSave.current_level_date) {
      cadreToSave.current_level_date = formatDate(cadreToSave.current_level_date);
    }
    
    if (cadreToSave.position_entry_date) {
      cadreToSave.position_entry_date = formatDate(cadreToSave.position_entry_date);
    }
    
    if (cadreToSave.probation_end_reminder) {
      cadreToSave.probation_end_reminder = formatDate(cadreToSave.probation_end_reminder);
    }
    
    if (cadreToSave.birth_date) {
      cadreToSave.birth_date = formatDate(cadreToSave.birth_date);
    }
    
    if (cadreToSave.party_entry_date) {
      cadreToSave.party_entry_date = formatDate(cadreToSave.party_entry_date);
    }
    
    // Á°Æ‰øùÊï∞Â≠óÂ≠óÊÆµË¢´Ê≠£Á°ÆÂ§ÑÁêÜ
    if (cadreToSave.probation_period !== null && cadreToSave.probation_period !== undefined) {
      cadreToSave.probation_period = cadreToSave.probation_period.toString();
    } else {
      cadreToSave.probation_period = null;
    }
    
    // ÂÖ∂‰ªñÊï∞Â≠óÂ≠óÊÆµ‰øùÊåÅÂéüÊ†∑ÔºåÂõ†‰∏∫ÂêéÁ´ØÊúüÊúõÁöÑÊòØÊï∞Â≠óÁ±ªÂûã
    // age, company_tenure, work_tenure Âú®ÂêéÁ´ØÊòØÊï∞Â≠óÁ±ªÂûãÔºå‰∏çÈúÄË¶ÅËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤
    
    if (cadreToSave.id) {
      // Êõ¥Êñ∞Áé∞ÊúâËÆ∞ÂΩï
      await invoke("update_cadre_info", { cadre: cadreToSave });
    } else {
      // Ê∑ªÂä†Êñ∞ËÆ∞ÂΩï
      await invoke("add_cadre_info", { cadre: cadreToSave });
    }
    closeModal();
    loadCadreInfo();
  } catch (error) {
    console.error("‰øùÂ≠òÂπ≤ÈÉ®‰ø°ÊÅØÂ§±Ë¥•:", error);
    if (error.name === 'ValidationError') {
      console.error("Ë°®ÂçïÈ™åËØÅÂ§±Ë¥•:", error);
    } else {
      console.error("‰øùÂ≠òÂπ≤ÈÉ®‰ø°ÊÅØÂ§±Ë¥•:", error);
    }
  }
}

// ÁºñËæëÂπ≤ÈÉ®‰ø°ÊÅØ
function editCadre(cadre) {
  // ÂàõÂª∫Ê∑±Êã∑Ë¥ù
  const cadreCopy = { ...cadre };
  
  // Â§ÑÁêÜÊó•ÊúüÂ≠óÊÆµÔºåÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Êó•ÊúüÂØπË±°
  if (cadreCopy.company_entry_date && typeof cadreCopy.company_entry_date === 'string') {
    cadreCopy.company_entry_date = new Date(cadreCopy.company_entry_date);
  }
  
  if (cadreCopy.work_start_date && typeof cadreCopy.work_start_date === 'string') {
    cadreCopy.work_start_date = new Date(cadreCopy.work_start_date);
  }
  
  if (cadreCopy.current_level_date && typeof cadreCopy.current_level_date === 'string') {
    cadreCopy.current_level_date = new Date(cadreCopy.current_level_date);
  }
  
  if (cadreCopy.position_entry_date && typeof cadreCopy.position_entry_date === 'string') {
    cadreCopy.position_entry_date = new Date(cadreCopy.position_entry_date);
  }
  
  if (cadreCopy.probation_end_reminder && typeof cadreCopy.probation_end_reminder === 'string') {
    cadreCopy.probation_end_reminder = new Date(cadreCopy.probation_end_reminder);
  }
  
  if (cadreCopy.birth_date && typeof cadreCopy.birth_date === 'string') {
    cadreCopy.birth_date = new Date(cadreCopy.birth_date);
  }
  
  if (cadreCopy.party_entry_date && typeof cadreCopy.party_entry_date === 'string') {
    cadreCopy.party_entry_date = new Date(cadreCopy.party_entry_date);
  }
  
  currentCadre.value = cadreCopy;
  showModal.value = true;
  
  // ÈáçÊñ∞ËÆ°ÁÆóÂè∏ÈæÑÂíåÂ∑•ÈæÑ
  if (currentCadre.value.company_entry_date) {
    calculateCompanyTenure();
  }
  
  if (currentCadre.value.work_start_date) {
    calculateWorkTenure();
  }
  
  // ÈáçÊñ∞ËÆ°ÁÆóËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜí
  if (currentCadre.value.probation_period && currentCadre.value.position_entry_date) {
    calculateProbationEnd();
  }
  
  // Â¶ÇÊûúÊúâË∫´‰ªΩËØÅÂè∑ÔºåÈáçÊñ∞ÊèêÂèñ‰ø°ÊÅØ
  if (currentCadre.value.id_number && currentCadre.value.id_number.length === 18) {
    extractIdInfo();
  }
}

// Âà†Èô§Âπ≤ÈÉ®‰ø°ÊÅØ
async function deleteCadre(id) {
  if (confirm("Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ËÆ∞ÂΩïÂêóÔºü")) {
    try {
      await invoke("delete_cadre_info", { id });
      loadCadreInfo();
    } catch (error) {
      console.error("Âà†Èô§Âπ≤ÈÉ®‰ø°ÊÅØÂ§±Ë¥•:", error);
    }
  }
}

// ÊâìÂºÄÊñ∞Â¢ûÂºπÁ™ó
function openAddModal() {
  resetForm();
  showModal.value = true;
}

// ÂÖ≥Èó≠ÂºπÁ™ó
function closeModal() {
  showModal.value = false;
}

// ÈáçÁΩÆË°®Âçï
function resetForm() {
  currentCadre.value = {
    id: null,
    name: "",
    gender: "",
    department: "",
    section: "",
    position1: "",
    position2: "",
    company_entry_date: "",
    company_tenure: null,
    work_start_date: "",
    work_tenure: null,
    current_level_date: "",
    position_entry_date: "",
    probation_period: null,
    probation_end_reminder: "",
    id_number: "",
    birth_date: "",
    age: null,
    native_place: "",
    birth_place: "",
    ethnicity: "",
    technical_position: "",
    education: "",
    full_time_education: "",
    full_time_school_major: "",
    part_time_education: "",
    part_time_school_phone: "",
    political_status: "",
    party_entry_date: "",
    phone: "",
    remarks: "",
    major: "",
    contact_date: "",
    special_date: ""
  };
}

// ÊâìÂºÄÂØºÂá∫ÈÖçÁΩÆÂºπÁ™ó
function openExportModal() {
  showExportModal.value = true;
}

// ÂÖ®ÈÄâ/ÂèñÊ∂àÂÖ®ÈÄâÂäüËÉΩ
function toggleSelectAll() {
  if (selectAll.value) {
    // ÂÖ®ÈÄâ
    selectedCadres.value = [...cadreList.value];
  } else {
    // ÂèñÊ∂àÂÖ®ÈÄâ
    selectedCadres.value = [];
  }
}

// ÁõëÂê¨ÈÄâ‰∏≠È°πÁöÑÂèòÂåñÔºåÊõ¥Êñ∞ÂÖ®ÈÄâÁä∂ÊÄÅ
watch(selectedCadres, (newVal) => {
  if (newVal.length === cadreList.value.length && newVal.length > 0) {
    selectAll.value = true;
  } else {
    selectAll.value = false;
  }
}, { deep: true });

// ÂÖ≥Èó≠ÂØºÂá∫ÈÖçÁΩÆÂºπÁ™ó
function closeExportModal() {
  showExportModal.value = false;
}

// ÂàáÊç¢Á≠õÈÄâÈù¢ÊùøÊòæÁ§∫Áä∂ÊÄÅ
function toggleFilterPanel() {
  showFilterPanel.value = !showFilterPanel.value;
}


// Â∫îÁî®Á≠õÈÄâÊù°‰ª∂
function applyFilters() {
  // Á≠õÈÄâÈÄªËæëÂ∞ÜÂú®Ê®°Êùø‰∏≠ÈÄöËøáËÆ°ÁÆóÂ±ûÊÄßÂÆûÁé∞
  console.log("Â∫îÁî®Á≠õÈÄâÊù°‰ª∂:", filters.value);
}

// Ê∏ÖÁ©∫Á≠õÈÄâÊù°‰ª∂
function clearFilters() {
  filters.value = {
    name: "",
    gender: "",
    department: "",
    section: "",
    position1: "",
    position2: "",
    education: "",
    politicalStatus: "",
    idNumber: "",
    nativePlace: "",
    ethnicity: "",
    technicalPosition: "",
    phone: "",
    ageMin: "",
    ageMax: "",
    birthPlace: "",
    fullTimeEducation: "",
    partTimeEducation: "",
    probationPeriod: "",
    fullTimeSchoolMajor: "",
    partTimeSchoolPhone: "",
    remarks: ""
  };
  filterDateRanges.value = {
    companyEntryDate: [],
    birthDate: [],
    workStart: [],
    currentLevel: [],
    positionEntry: [],
    partyEntry: [],
    probationEndReminder: []
  };
}

// ÂàáÊç¢ÂÖ®ÈÄâÂ≠óÊÆµ
function toggleAllFields() {
  if (exportConfig.value.selectAllFields) {
    exportConfig.value.selectedFields = exportFields.map(field => field.key);
  } else {
    exportConfig.value.selectedFields = [];
  }
}

// ÈáçÁΩÆÂ≠óÊÆµÈÄâÊã©
function resetFields() {
  exportConfig.value.selectedFields = exportFields.map(field => field.key);
  exportConfig.value.selectAllFields = true;
}

// ÊâßË°åÂØºÂá∫Êìç‰Ωú
async function performExport() {
  try {
    // ÊûÑÈÄ†Êñá‰ª∂Ë∑ØÂæÑ
    const filePath = `${exportConfig.value.fileName}.xlsx`;
    
    // Ëé∑ÂèñË¶ÅÂØºÂá∫ÁöÑÊï∞ÊçÆIDÂàóË°®ÔºàÂ¶ÇÊûúÊòØÈÄâ‰∏≠ÂØºÂá∫Ôºâ
    let cadreIds = null;
    if (selectedCadres.value.length > 0) {
      cadreIds = selectedCadres.value.map(cadre => cadre.id);
    }
    
    await invoke("export_cadre_info_to_excel", { 
      filePath, 
      selectedFields: exportConfig.value.selectedFields,
      cadreIds // Â¶ÇÊûú‰∏∫nullÂàôÂØºÂá∫ÂÖ®ÈÉ®
    });
    
    closeExportModal();
    alert("ÂØºÂá∫ÊàêÂäüÔºÅÊñá‰ª∂Â∑≤‰øùÂ≠ò‰∏∫: " + filePath);
  } catch (error) {
    console.error("ÂØºÂá∫Â§±Ë¥•:", error);
    alert("ÂØºÂá∫Â§±Ë¥•: " + error);
  }
}

// ÂéüÂßãÁöÑÂØºÂá∫ÂáΩÊï∞‰øùÊåÅÂÖºÂÆπÊÄß
async function exportToExcel() {
  try {
    // ‰ΩøÁî®Âõ∫ÂÆöÊñá‰ª∂Ë∑ØÂæÑËøõË°åÊµãËØï
    const filePath = "Âπ≤ÈÉ®‰ø°ÊÅØ.xlsx";
    
    // ÂØºÂá∫ÊâÄÊúâÂ≠óÊÆµ
    const selectedFields = exportFields.map(field => field.key);
    
    await invoke("export_cadre_info_to_excel", { 
      filePath, 
      selectedFields: selectedFields 
    });
    
    alert("ÂØºÂá∫ÊàêÂäüÔºÅÊñá‰ª∂Â∑≤‰øùÂ≠ò‰∏∫: " + filePath);
  } catch (error) {
    console.error("ÂØºÂá∫Â§±Ë¥•:", error);
    alert("ÂØºÂá∫Â§±Ë¥•: " + error);
  }
}

// ÂØºÂá∫ÈÄâ‰∏≠Âπ≤ÈÉ®‰ø°ÊÅØ
async function exportSelectedCadres() {
  if (selectedCadres.value.length === 0) {
    alert("ËØ∑ÂÖàÈÄâÊã©Ë¶ÅÂØºÂá∫ÁöÑÂπ≤ÈÉ®‰ø°ÊÅØ");
    return;
  }
  
  try {
    // ÊâìÂºÄÂØºÂá∫ÈÖçÁΩÆÂºπÁ™óÔºåËÆæÁΩÆÈªòËÆ§Êñá‰ª∂Âêç‰∏∫"ÈÄâ‰∏≠Âπ≤ÈÉ®‰ø°ÊÅØ"
    exportConfig.value.fileName = "ÈÄâ‰∏≠Âπ≤ÈÉ®‰ø°ÊÅØ";
    showExportModal.value = true;
  } catch (error) {
    console.error("ÂØºÂá∫ÈÄâ‰∏≠Âπ≤ÈÉ®‰ø°ÊÅØÂ§±Ë¥•:", error);
    alert("ÂØºÂá∫Â§±Ë¥•: " + error);
  }
}

// ÂØºÂá∫ÂÖ®ÈÉ®Âπ≤ÈÉ®‰ø°ÊÅØ
async function exportAllCadres() {
  try {
    // ÊâìÂºÄÂØºÂá∫ÈÖçÁΩÆÂºπÁ™óÔºåËÆæÁΩÆÈªòËÆ§Êñá‰ª∂Âêç‰∏∫"ÂÖ®ÈÉ®Âπ≤ÈÉ®‰ø°ÊÅØ"
    exportConfig.value.fileName = "ÂÖ®ÈÉ®Âπ≤ÈÉ®‰ø°ÊÅØ";
    showExportModal.value = true;
  } catch (error) {
    console.error("ÂØºÂá∫ÂÖ®ÈÉ®Âπ≤ÈÉ®‰ø°ÊÅØÂ§±Ë¥•:", error);
    alert("ÂØºÂá∫Â§±Ë¥•: " + error);
  }
}

// Ëé∑ÂèñÈÉ®Èó®ÁªüËÆ°‰ø°ÊÅØ
function getDepartmentStats() {
  const stats = {};
  cadreList.value.forEach(cadre => {
    if (cadre.department) {
      stats[cadre.department] = (stats[cadre.department] || 0) + 1;
    }
  });
  return stats;
}

// ËÆ°ÁÆóÂè∏ÈæÑ
function calculateCompanyTenure() {
  if (currentCadre.value.company_entry_date) {
    // Á°Æ‰øùÊó•ÊúüÊòØDateÂØπË±°
    const entryDate = currentCadre.value.company_entry_date instanceof Date 
      ? currentCadre.value.company_entry_date 
      : new Date(currentCadre.value.company_entry_date);
    
    if (isNaN(entryDate.getTime())) {
      currentCadre.value.company_tenure = null;
      return;
    }
    
    const today = new Date();
    const diffTime = Math.abs(today - entryDate);
    const diffYears = diffTime / (1000 * 60 * 60 * 24 * 365);
    currentCadre.value.company_tenure = parseFloat(diffYears.toFixed(1));
  } else {
    currentCadre.value.company_tenure = null;
  }
}

// ËÆ°ÁÆóÂ∑•ÈæÑ
function calculateWorkTenure() {
  if (currentCadre.value.work_start_date) {
    // Á°Æ‰øùÊó•ÊúüÊòØDateÂØπË±°
    const startDate = currentCadre.value.work_start_date instanceof Date 
      ? currentCadre.value.work_start_date 
      : new Date(currentCadre.value.work_start_date);
    
    if (isNaN(startDate.getTime())) {
      currentCadre.value.work_tenure = null;
      return;
    }
    
    const today = new Date();
    const diffTime = Math.abs(today - startDate);
    const diffYears = diffTime / (1000 * 60 * 60 * 24 * 365);
    currentCadre.value.work_tenure = parseFloat(diffYears.toFixed(1));
  } else {
    currentCadre.value.work_tenure = null;
  }
}

// ËÆ°ÁÆóËØïÁî®ÊúüÊª°Âà∞ÊúüÊèêÈÜí
function calculateProbationEnd() {
  // Âè™ÊúâÂΩìËØïÁî®ÊúüÂíå‰ªªËÅåÊó∂Èó¥ÈÉΩÂ≠òÂú®Êó∂ÊâçËÆ°ÁÆó
  if (currentCadre.value.probation_period && currentCadre.value.position_entry_date) {
    // Á°Æ‰øùÊó•ÊúüÊòØDateÂØπË±°
    const positionDate = currentCadre.value.position_entry_date instanceof Date 
      ? currentCadre.value.position_entry_date 
      : new Date(currentCadre.value.position_entry_date);
    
    if (isNaN(positionDate.getTime())) {
      currentCadre.value.probation_end_reminder = "";
      return;
    }
    
    const probationYears = parseFloat(currentCadre.value.probation_period);
    
    // ËÆ°ÁÆóËØïÁî®ÊúüÁªìÊùüÊó•Êúü
    const endDate = new Date(positionDate);
    endDate.setFullYear(endDate.getFullYear() + Math.floor(probationYears));
    endDate.setMonth(endDate.getMonth() + Math.round((probationYears % 1) * 12));
    
    // Áõ¥Êé•ËÆæÁΩÆÊó•ÊúüÂØπË±°
    currentCadre.value.probation_end_reminder = endDate;
  } else {
    currentCadre.value.probation_end_reminder = "";
  }
}

// ‰ªéË∫´‰ªΩËØÅÂè∑ÊèêÂèñÂá∫ÁîüÊó•ÊúüÂíåÂπ¥ÈæÑ
function extractIdInfo() {
  const idNumber = currentCadre.value.id_number;
  if (idNumber && idNumber.length === 18) {
    // ÊèêÂèñÂá∫ÁîüÊó•Êúü (Á¨¨7-14‰Ωç)
    const birthYear = idNumber.substring(6, 10);
    const birthMonth = idNumber.substring(10, 12);
    const birthDay = idNumber.substring(12, 14);
    
    // ÂàõÂª∫Êó•ÊúüÂØπË±°
    const birthDate = new Date(birthYear, birthMonth - 1, birthDay);
    
    // Ê£ÄÊü•Êó•ÊúüÊòØÂê¶ÊúâÊïà
    if (!isNaN(birthDate.getTime())) {
      // ËÆæÁΩÆÊó•ÊúüÂØπË±°
      currentCadre.value.birth_date = birthDate;
      
      // ËÆ°ÁÆóÂπ¥ÈæÑ
      const today = new Date();
      let age = today.getFullYear() - birthDate.getFullYear();
      const monthDiff = today.getMonth() - birthDate.getMonth();
      
      // Â¶ÇÊûúËøòÊ≤°ËøáÁîüÊó•ÔºåÂàôÂπ¥ÈæÑÂáè1
      if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
        age--;
      }
      
      currentCadre.value.age = age;
    } else {
      currentCadre.value.birth_date = "";
      currentCadre.value.age = null;
    }
  } else {
    currentCadre.value.birth_date = "";
    currentCadre.value.age = null;
  }
}



// ÁªÑ‰ª∂ÊåÇËΩΩÊó∂Âä†ËΩΩÊï∞ÊçÆ
onMounted(() => {
  loadCadreInfo();
});
</script>

<style>
/* ÂÖ®Â±ÄÊ†∑Âºè‰øÆÂ§ç */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}

#app {
  height: 100%;
}

/* Áé∞‰ª£ÂåñÈÖçËâ≤ÊñπÊ°à */
:root {
  --primary-color: #4361ee;
  --primary-light: #4895ef;
  --primary-dark: #3f37c9;
  --secondary-color: #7209b7;
  --success-color: #4cc9f0;
  --warning-color: #f72585;
  --danger-color: #e63946;
  --info-color: #4cc9f0;
  --light-bg: #f8f9fa;
  --dark-bg: #212529;
  --text-primary: #212529;
  --text-secondary: #6c757d;
  --border-color: #dee2e6;
  --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  --hover-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
}
</style>

<style scoped>
.app-container {
  display: flex;
  height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  overflow: hidden;
  background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
}

.sidebar {
  width: 250px;
  background: linear-gradient(180deg, #2d3748, #1a202c);
  color: #e2e8f0;
  box-shadow: 4px 0 20px rgba(0, 0, 0, 0.15);
  overflow-y: auto;
  height: 100vh;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  border-right: 1px solid #4a5568;
  padding: 20px 0;
}


.logo {
  padding: 20px 20px 25px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  margin-bottom: 0;
  text-align: center;
}

.logo h2 {
  margin: 0;
  font-size: 1.6rem;
  font-weight: 700;
  color: #ffffff;
  letter-spacing: 0.5px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.menu {
  padding: 20px 10px 0;
  overflow-y: auto;
  flex: 1;
}

.menu-item {
  display: flex;
  align-items: center;
  width: calc(100% - 20px);
  padding: 16px 20px;
  background: transparent;
  border: none;
  color: #cbd5e0;
  font-size: 1.05rem;
  text-align: left;
  cursor: pointer;
  border-radius: 10px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  margin: 0 10px 8px;
  position: relative;
  overflow: hidden;
  font-weight: 500;
}

.menu-item:last-child {
  margin-bottom: 20px;
}

.menu-item:hover {
  background: rgba(255, 255, 255, 0.1);
  color: #ffffff;
  transform: translateX(3px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.menu-item.active {
  background: linear-gradient(90deg, var(--primary-color), #5a7dff);
  color: white;
  font-weight: 600;
  box-shadow: 0 6px 12px rgba(67, 97, 238, 0.25);
}

.menu-item.active:hover {
  transform: translateX(0);
  box-shadow: 0 8px 16px rgba(67, 97, 238, 0.3);
}

.menu-item::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 3px;
  background: transparent;
  border-radius: 0 2px 2px 0;
  transition: all 0.3s ease;
}

.menu-item.active::before {
  background: #ffffff;
}

.menu-icon {
  margin-right: 12px;
  font-size: 1.2rem;
}

.main-content {
  flex: 1;
  padding: 25px;
  overflow-y: auto;
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  min-height: 100vh;
}

.content-section {
  background: white;
  border-radius: 16px;
  padding: 30px;
  box-shadow: var(--card-shadow);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.content-section:hover {
  transform: translateY(-3px);
  box-shadow: var(--hover-shadow);
}

.content-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
  border-radius: 16px 16px 0 0;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 2px solid #f1f5f9;
}

.header-actions {
  display: flex;
  gap: 10px;
}

.section-header h2 {
  margin: 0;
  color: #1e293b;
  font-size: 2rem;
  font-weight: 700;
  letter-spacing: -0.5px;
  position: relative;
  padding-bottom: 10px;
}

.section-header h2::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 60px;
  height: 4px;
  background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
  border-radius: 2px;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color: white;
  border: none;
  padding: 14px 28px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 1.05rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
  position: relative;
  overflow: hidden;
  letter-spacing: 0.3px;
}

.btn-primary:hover {
  background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
}

.btn-primary:active {
  transform: translateY(-1px);
  box-shadow: 0 4px 10px rgba(67, 97, 238, 0.3);
}

.btn-primary::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.6s ease;
}

.btn-primary:hover::before {
  left: 100%;
}

.btn-primary:focus {
  outline: none;
  box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.2);
}

.horizontal-table-container {
  overflow-x: auto;
  border-radius: 12px;
  box-shadow: var(--card-shadow);
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.table-header {
  position: sticky;
  top: 0;
  z-index: 10;
}

.table-row {
  display: flex;
  border-bottom: 1px solid #f1f5f9;
  transition: all 0.2s ease;
  position: relative;
}

.table-row:hover {
  background-color: #f8fafc;
}

.table-row:nth-child(even) {
  background-color: #fdfdfd;
}

.table-row:nth-child(even):hover {
  background-color: #f8fafc;
}

.header-row {
  background: linear-gradient(180deg, #f8fafc, #f1f5f9);
  font-weight: 700;
  color: #1e293b;
  position: sticky;
  top: 0;
  z-index: 10;
  box-shadow: 0 3px 6px rgba(0,0,0,0.05);
  border-bottom: 2px solid #e2e8f0;
}

.table-cell {
  flex: 1;
  min-width: 120px;
  padding: 14px 16px;
  text-align: left;
  border-right: 1px solid #f1f5f9;
  word-break: break-word;
  display: flex;
  align-items: center;
  transition: background-color 0.2s ease;
  position: relative;
  color: #334155;
  font-size: 0.95rem;
}

.table-cell:last-child {
  border-right: none;
}

/* ÈÄâÊã©ÂàóÊ†∑Âºè */
.table-cell:first-child {
  flex: 0 0 60px;
  justify-content: center;
  background-color: #f8fafc;
  font-weight: 500;
}

/* Â∫èÂè∑ÂàóÊ†∑Âºè */
.table-cell:nth-child(2) {
  flex: 0 0 60px;
  justify-content: center;
  background-color: #f8fafc;
  font-weight: 500;
}

/* Êìç‰ΩúÂàóÊ†∑Âºè */
.actions-cell {
  flex: 0 0 120px;
  display: flex;
  gap: 8px;
  align-items: center;
  justify-content: center;
  background-color: #f8fafc;
}

.actions-cell .btn-small {
  margin: 0;
}

/* Ë°®Â§¥ÂçïÂÖÉÊ†ºÊ†∑Âºè */
.header-row .table-cell {
  background: linear-gradient(180deg, #f1f5f9, #e2e8f0);
  font-weight: 700;
  color: #1e293b;
  text-align: center;
  padding: 16px;
  border-bottom: 2px solid #cbd5e0;
}

/* Â•áÂÅ∂Ë°åÊ†∑Âºè */
.table-row:nth-child(even) .table-cell {
  background-color: #fdfdfd;
}

.table-row:nth-child(odd) .table-cell {
  background-color: white;
}

.table-row:hover .table-cell {
  background-color: #f1f5f9;
}

.table-row:hover .table-cell:first-child,
.table-row:hover .table-cell:nth-child(2),
.table-row:hover .actions-cell {
  background-color: #e2e8f0;
}

.btn-small {
  padding: 8px 14px;
  margin-right: 6px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.btn-small:not(.btn-danger) {
  background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
  color: white;
}

.btn-small:not(.btn-danger):hover {
  background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(67, 97, 238, 0.2);
}

.btn-small:not(.btn-danger):active {
  transform: translateY(0);
  box-shadow: 0 2px 4px rgba(67, 97, 238, 0.15);
}

.btn-danger {
  background: linear-gradient(135deg, var(--danger-color), #d90429);
  color: white;
}

.btn-danger:hover {
  background: linear-gradient(135deg, #d90429, var(--danger-color));
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(230, 57, 70, 0.25);
}

.btn-danger:active {
  transform: translateY(0);
  box-shadow: 0 2px 4px rgba(230, 57, 70, 0.2);
}

.btn-small::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s ease;
}

.btn-small:hover::before {
  left: 100%;
}

.btn-small:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
}

.btn-danger:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.2);
}

/* ÁªüËÆ°È°µÈù¢Ê†∑Âºè */
.statistics-content {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
  margin-top: 25px;
}

.stat-card {
  background: linear-gradient(135deg, white, #f8fafc);
  border-radius: 18px;
  padding: 30px;
  box-shadow: var(--card-shadow);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(0, 0, 0, 0.03);
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--hover-shadow);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 5px;
  background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
}

.stat-card h3 {
  margin-top: 0;
  color: #1e293b;
  font-size: 1.3rem;
  font-weight: 700;
  position: relative;
  padding-bottom: 12px;
  letter-spacing: -0.3px;
}

.stat-card h3::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 50px;
  height: 3px;
  background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
  border-radius: 2px;
}

.stat-number {
  font-size: 2.8rem;
  font-weight: 800;
  color: var(--primary-color);
  margin: 15px 0;
  text-shadow: 0 2px 8px rgba(67, 97, 238, 0.15);
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* ÂºπÁ™óÊ†∑Âºè */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(8px);
  animation: overlayFadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal-content {
  background: linear-gradient(135deg, white, #f8fafc);
  border-radius: 16px;
  width: 95%;
  max-width: 1000px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.3);
  animation: modalFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

@keyframes overlayFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes modalFadeIn {
  from {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 25px 30px;
  border-bottom: 1px solid #edf2f7;
  background-color: #f8fafc;
  border-radius: 16px 16px 0 0;
}

.modal-header h3 {
  margin: 0;
  color: #1a202c;
  font-size: 1.5rem;
  font-weight: 600;
}

.modal-close {
  background: none;
  border: none;
  font-size: 1.8rem;
  cursor: pointer;
  color: #a0aec0;
  padding: 0;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.2s ease;
}

.modal-close:hover {
  background: #e2e8f0;
  color: #1a202c;
}

.modal-body {
  padding: 30px;
  background-color: white;
}

/* Ë°®ÂçïÂàÜÁªÑÊ†∑Âºè */
.form-section {
  margin-bottom: 30px;
  padding: 20px;
  border-radius: 12px;
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  border: 1px solid #e2e8f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
}

.form-section:last-child {
  margin-bottom: 0;
}

.form-section-title {
  font-size: 1.3rem;
  font-weight: 700;
  color: #1e293b;
  margin: 0 0 20px 0;
  padding-bottom: 12px;
  border-bottom: 3px solid #4299e1;
  display: inline-block;
  position: relative;
}

.form-section-title::after {
  content: '';
  position: absolute;
  bottom: -3px;
  left: 0;
  width: 60px;
  height: 3px;
  background: linear-gradient(90deg, #4299e1, #3182ce);
  border-radius: 2px;
}

.form-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 25px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

.form-group.full-width {
  grid-column: 1 / -1;
}

.form-group label {
  margin-bottom: 8px;
  font-weight: 600;
  color: #334155;
  font-size: 0.95rem;
  position: relative;
  padding-left: 8px;
}

.form-group label::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 16px;
  background: linear-gradient(180deg, #4299e1, #3182ce);
  border-radius: 2px;
}

/* Áªü‰∏ÄÁöÑËæìÂÖ•Ê°ÜÊ†∑Âºè */
.form-group input,
.form-group select,
.form-group textarea,
.datepicker-input {
  padding: 14px 18px !important;
  border: 2px solid #e2e8f0 !important;
  border-radius: 10px !important;
  font-size: 1.05rem !important;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  box-sizing: border-box !important;
  background-color: white !important;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05) !important;
  min-height: 46px !important;
  outline: none !important;
  position: relative;
  font-family: inherit !important;
  color: #1e293b !important;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus,
.datepicker-input:focus {
  outline: none !important;
  border-color: var(--primary-color) !important;
  box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.2) !important;
  transform: translateY(-2px);
}

.form-group input:hover,
.form-group select:hover,
.form-group textarea:hover,
.datepicker-input:hover {
  border-color: #cbd5e0 !important;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08) !important;
}

/* Áªü‰∏ÄÁöÑÂè™ËØªÊ†∑Âºè */
.form-group input[readonly],
.form-group input:disabled,
.form-group select:disabled,
.form-group textarea:disabled,
.datepicker-input:disabled,
:deep(.dp__input_wrap input:disabled) {
  background-color: #f8fafc !important;
  color: #64748b !important;
  cursor: not-allowed !important;
  opacity: 1 !important;
  border-color: #e2e8f0 !important;
}

.form-group input[readonly]:focus,
.form-group input:disabled:focus,
.form-group select:disabled:focus,
.form-group textarea:disabled:focus,
.datepicker-input:disabled:focus {
  outline: none !important;
  border-color: #e2e8f0 !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
}

/* ÁâπÊÆäÂ§ÑÁêÜÈÄâÊã©Ê°Ü */
.form-group select {
  appearance: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e") !important;
  background-repeat: no-repeat !important;
  background-position: right 16px center !important;
  background-size: 18px !important;
  padding-right: 45px !important;
}

/* ÁâπÊÆäÂ§ÑÁêÜÈÄâÊã©Ê°Ü‰ª•‰øùÊåÅËßÜËßâ‰∏ÄËá¥ÊÄß */
.form-group select {
  appearance: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e") !important;
  background-repeat: no-repeat !important;
  background-position: right 16px center !important;
  background-size: 16px !important;
  padding-right: 40px !important; /* ‰∏∫‰∏ãÊãâÁÆ≠Â§¥ÁïôÂá∫Á©∫Èó¥ */
}

/* Áªü‰∏ÄÁöÑÂè™ËØªÊ†∑Âºè */
.form-group input[readonly],
.form-group input:disabled,
.form-group select:disabled,
.form-group textarea:disabled,
.datepicker-input:disabled,
:deep(.dp__input_wrap input:disabled) {
  background-color: #e2e8f0 !important;
  color: #4a5568 !important;
  cursor: not-allowed !important;
  opacity: 1 !important;
  border-color: #e2e8f0 !important;
}

.form-group input[readonly]:focus,
.form-group input:disabled:focus,
.form-group select:disabled:focus,
.form-group textarea:disabled:focus,
.datepicker-input:disabled:focus {
  outline: none !important;
  border-color: #e2e8f0 !important;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05) !important;
}

/* Êó•ÊúüÈÄâÊã©Âô®ÊÇ¨ÂÅúÊ†∑Âºè */
.datepicker-input:hover:not(:disabled) {
  border-color: #cbd5e0 !important;
}

/* ÁâπÊÆäÂ§ÑÁêÜtextareaÁöÑÈ´òÂ∫¶ */
.form-group textarea {
  min-height: 120px !important;
  resize: vertical !important;
  font-family: inherit !important;
}

/* ÂÖ®Â±ÄÊó•ÊúüÈÄâÊã©Âô®Ê†∑Âºè */
:deep(.dp__theme_light) {
  --dp-primary-color: #4299e1;
  --dp-secondary-color: #3182ce;
  --dp-border-radius: 8px;
  --dp-menu-border-color: #e2e8f0;
  --dp-background-color: #ffffff;
  --dp-text-color: #1a202c;
  --dp-hover-color: #f1f5f9;
  --dp-selected-color: #4299e1;
}

:deep(.dp__action_buttons) {
  display: none;
}

:deep(.dp__menu) {
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  animation: datepickerFadeIn 0.2s ease;
  z-index: 1100;
  border: 1px solid #e2e8f0;
}

:deep(.dp__cell_inner) {
  border-radius: 50%;
  font-weight: 500;
  transition: all 0.2s ease;
}

:deep(.dp__cell_inner:hover) {
  background-color: #f7fafc;
}

:deep(.dp__today) {
  border: 1px solid var(--dp-primary-color);
  background-color: #ebf8ff;
}

:deep(.dp__active_date) {
  background-color: var(--dp-primary-color);
  color: white;
}

:deep(.dp__active_date:hover) {
  background-color: var(--dp-primary-color);
}

:deep(.dp__month_year_select) {
  font-weight: 600;
  border-radius: 6px;
  padding: 4px 8px;
}

:deep(.dp__month_year_select:hover) {
  background-color: #f7fafc;
}

:deep(.dp__overlay_cell_active) {
  background-color: var(--dp-primary-color);
  color: white;
}

@keyframes datepickerFadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.form-group textarea {
  min-height: 120px;
  resize: vertical;
  font-family: inherit;
}

/* ÁªÑÂêàËæìÂÖ•Ê°ÜÊ†∑Âºè */
.combobox-input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.2s ease;
  box-sizing: border-box;
  background-color: white;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

/* Ë°®Ê†ºÂ§çÈÄâÊ°ÜÊ†∑Âºè */
.row-checkbox {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--primary-color);
  transform: scale(1.1);
  margin: 0 auto;
  border-radius: 5px;
  border: 2px solid #cbd5e0;
  transition: all 0.2s ease;
}

/* Êñá‰ª∂ÂêçËæìÂÖ•Ê°ÜÊ†∑Âºè */
.filename-input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.2s ease;
  box-sizing: border-box;
  background-color: white;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.filename-input:focus {
  outline: none;
  border-color: #4299e1;
  box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
}

/* Êñá‰ª∂ÂêçË°åÊ†∑Âºè - Ê†áÁ≠æÂíåËæìÂÖ•Ê°ÜÂú®Âêå‰∏ÄË°å */
.filename-row-container {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 20px;
}

.filename-label {
  white-space: nowrap;
  margin-bottom: 0;
  flex: 0 0 auto;
  font-weight: 500;
  color: #334155;
}

.filename-input {
  flex: 1;
  margin-bottom: 0;
  padding: 12px 16px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.2s ease;
  box-sizing: border-box;
  background-color: white;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.filename-input:focus {
  outline: none;
  border-color: #4299e1;
  box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
}


/* Â≠óÊÆµÈÄâÊã©ÈÉ®ÂàÜÊ†∑Âºè */
.field-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.field-section-header h4 {
  margin: 0;
}

.field-actions {
  display: flex;
  gap: 15px;
  align-items: center;
}

/* ÈáçÁΩÆÊåâÈíÆÊ†∑Âºè - Êõ¥Â∞èÁöÑÂ∞∫ÂØ∏ */
.btn-reset {
  background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
  color: #4a5568;
  border: 1px solid #cbd5e0;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 500;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
  letter-spacing: 0.3px;
  white-space: nowrap;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.btn-reset:hover {
  background: linear-gradient(135deg, #e2e8f0, #cbd5e0);
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
  color: #2d3748;
  border-color: #a0aec0;
}

.btn-reset:active {
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
}

.btn-reset::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s ease;
}

.btn-reset:hover::before {
  left: 100%;
}

.btn-reset:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(203, 213, 224, 0.3);
}

/* Ê®°ÊÄÅÊ°ÜÊåâÈíÆÊ†∑Âºè - Êõ¥Â∞èÁöÑÂ∞∫ÂØ∏ */
.btn-modal-secondary {
  background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
  color: #4a5568;
  border: 1px solid #cbd5e0;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 500;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
  letter-spacing: 0.3px;
}

.btn-modal-secondary:hover {
  background: linear-gradient(135deg, #e2e8f0, #cbd5e0);
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
  color: #2d3748;
  border-color: #a0aec0;
}

.btn-modal-secondary:active {
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
}

.btn-modal-secondary::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s ease;
}

.btn-modal-secondary:hover::before {
  left: 100%;
}

.btn-modal-secondary:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(203, 213, 224, 0.3);
}

.btn-modal-primary {
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 3px rgba(67, 97, 238, 0.3);
  position: relative;
  overflow: hidden;
  letter-spacing: 0.3px;
}

.btn-modal-primary:hover {
  background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(67, 97, 238, 0.4);
}

.btn-modal-primary:active {
  transform: translateY(0);
  box-shadow: 0 1px 3px rgba(67, 97, 238, 0.3);
}

.btn-modal-primary::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.6s ease;
}

.btn-modal-primary:hover::before {
  left: 100%;
}

.btn-modal-primary:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
}

/* Â≠óÊÆµÁΩëÊ†ºÂ∏ÉÂ±Ä - Â§öË°åÊ®™ÂêëÊéíÂàó */
.field-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 15px;
  max-height: 300px;
  overflow-y: auto;
  padding: 10px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  background-color: #f8fafc;
}

.field-item {
  display: flex;
  align-items: center;
  padding: 8px 12px;
  background-color: white;
  border-radius: 6px;
  border: 1px solid #e2e8f0;
  transition: all 0.2s ease;
}

.field-item:hover {
  background-color: #f1f5f9;
  border-color: #cbd5e0;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  width: 100%;
  margin-bottom: 0;
}

.checkbox-input {
  width: 18px;
  height: 18px;
  cursor: pointer;
  accent-color: var(--primary-color);
}

.row-checkbox:hover {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
}

/* Ë°®Â§¥Â§çÈÄâÊ°ÜÊ†∑Âºè */
.header-row .row-checkbox {
  transform: scale(1.1);
  border-color: #a0aec0;
}

.header-row .row-checkbox:hover {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
}

.combobox-input:focus {
  outline: none;
  border-color: #4299e1;
  box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
}

/* Á≠õÈÄâÊù°‰ª∂Èù¢ÊùøÊ†∑Âºè */
.filter-panel {
  background: linear-gradient(135deg, white, #f8fafc);
  border-radius: 12px;
  padding: 20px;
  box-shadow: var(--card-shadow);
  margin-bottom: 20px;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

/* Á≠õÈÄâÊù°‰ª∂Â±ïÂºÄ/Êî∂Ëµ∑ÊåâÈíÆÊ†∑Âºè‰ºòÂåñ */
.toggle-filter-button {
  padding: 12px 24px !important; /* Â¢ûÂ§ßÂÜÖËæπË∑ù */
  font-size: 1.1rem !important; /* Â¢ûÂ§ßÂ≠ó‰Ωì */
  min-height: 44px !important; /* ËÆæÁΩÆÊúÄÂ∞èÈ´òÂ∫¶ */
  border-radius: 10px !important; /* Â¢ûÂ§ßÂúÜËßí */
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important; /* Ê∑ªÂä†ËøáÊ∏°Âä®Áîª */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important; /* Ê∑ªÂä†Èò¥ÂΩ± */
}

.toggle-filter-button:hover {
  transform: translateY(-2px) !important; /* ÊÇ¨ÂÅúÊó∂‰∏äÁßª */
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15) !important; /* ÊÇ¨ÂÅúÊó∂Â¢ûÂº∫Èò¥ÂΩ± */
}

.toggle-filter-button:active {
  transform: translateY(0) !important; /* ÁÇπÂáªÊó∂ÊÅ¢Â§çÂéü‰Ωç */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important; /* ÁÇπÂáªÊó∂ÂáèÂº±Èò¥ÂΩ± */
}

.filter-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.filter-header h3 {
  margin: 0;
  color: #1e293b;
  font-size: 1.3rem;
  font-weight: 600;
}

.filter-content {
  padding: 15px 0;
}

.filter-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-bottom: 16px;
}

.filter-group {
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 12px;
}

.filter-group label {
  flex: 0 0 auto;
  min-width: 80px;
  margin-bottom: 0;
  font-weight: 500;
  color: #334155;
  font-size: 0.95rem;
  white-space: nowrap;
}

.filter-input,
.filter-select {
  flex: 1;
  padding: 10px 14px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.2s ease;
  box-sizing: border-box;
  background-color: white;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  min-height: 42px;
}

.filter-input:focus,
.filter-select:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
}

.filter-input:hover,
.filter-select:hover {
  border-color: #cbd5e0;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

/* Êó•ÊúüËåÉÂõ¥Êéß‰ª∂Ê†∑Âºè */
.date-range-container {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 4px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  min-height: 42px;
}

.date-range-input {
  flex: 1;
  border: none !important;
  padding: 10px 12px !important;
  font-size: 1rem !important;
  outline: none !important;
  background-color: transparent !important;
  box-shadow: none !important;
  min-height: auto !important;
}

.date-range-input:focus {
  outline: none !important;
  border: none !important;
  box-shadow: none !important;
}

.date-range-separator {
  color: #64748b;
  font-size: 0.9rem;
  font-weight: 500;
  white-space: nowrap;
  padding: 0 4px;
}

/* Âπ¥ÈæÑËåÉÂõ¥Êéß‰ª∂Ê†∑Âºè */
.age-range-container {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 4px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  min-height: 42px;
}

.age-range-input {
  flex: 1;
  border: none !important;
  padding: 10px 12px !important;
  font-size: 1rem !important;
  outline: none !important;
  background-color: transparent !important;
  box-shadow: none !important;
  min-height: auto !important;
  text-align: center;
}

.age-range-input:focus {
  outline: none !important;
  border: none !important;
  box-shadow: none !important;
}

.age-range-separator {
  color: #64748b;
  font-size: 0.9rem;
  font-weight: 500;
  white-space: nowrap;
  padding: 0 4px;
}

.age-range-unit {
  color: #64748b;
  font-size: 0.9rem;
  font-weight: 500;
  white-space: nowrap;
  padding: 0 4px;
}

/* ÂìçÂ∫îÂºèËÆæËÆ° - Á≠õÈÄâÊéß‰ª∂ */
@media (max-width: 1200px) {
  .filter-row {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 992px) {
  .filter-row {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .filter-row {
    grid-template-columns: 1fr;
  }
  
  .filter-group {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .filter-group label {
    min-width: auto;
    margin-bottom: 0;
    white-space: normal;
  }
  
  .filter-input,
  .filter-select {
    width: 100%;
  }
  
  .date-range-container {
    flex-direction: column;
    gap: 6px;
  }
  
  .date-range-separator {
    width: 100%;
    text-align: center;
    padding: 4px 0;
  }
  
  .age-range-container {
    flex-direction: column;
    gap: 6px;
    padding: 6px;
  }
  
  .age-range-separator,
  .age-range-unit {
    width: 100%;
    text-align: center;
    padding: 4px 0;
  }
}

.filter-actions {
  display: flex;
  gap: 15px;
  justify-content: flex-end;
  padding-top: 15px;
  border-top: 1px solid #e2e8f0;
}


.form-actions {
  display: flex;
  justify-content: flex-end;
  gap: 15px;
  margin-top: 30px;
  padding-top: 25px;
  border-top: 2px solid #e2e8f0;
  background: linear-gradient(180deg, transparent, #f8fafc);
  border-radius: 0 0 12px 12px;
  padding: 25px;
}

.btn-secondary {
  background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
  color: #4a5568;
  border: 1px solid #cbd5e0;
  padding: 14px 28px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 1.05rem;
  font-weight: 500;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  position: relative;
  overflow: hidden;
  letter-spacing: 0.3px;
}

.btn-secondary:hover {
  background: linear-gradient(135deg, #e2e8f0, #cbd5e0);
  transform: translateY(-3px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  color: #2d3748;
  border-color: #a0aec0;
}

.btn-secondary:active {
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

.btn-secondary::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s ease;
}

.btn-secondary:hover::before {
  left: 100%;
}

.btn-secondary:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(203, 213, 224, 0.3);
}

/* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 768px) {
  .app-container {
    flex-direction: column;
  }
  
  .sidebar {
    width: 100%;
    padding: 10px 0;
    height: auto;
    max-height: 200px;
  }
  
  .menu {
    display: flex;
    padding: 0 10px;
    flex-wrap: wrap;
  }
  
  .menu-item {
    flex: 1 1 auto;
    margin: 0 5px 5px 0;
    padding: 12px;
    font-size: 0.9rem;
    min-width: 120px;
  }
  
  .menu-icon {
    margin-right: 5px;
  }
  
  .main-content {
    padding: 15px;
  }
  
  .content-section {
    padding: 20px;
  }
  
  .section-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 15px;
  }
  
  .header-actions {
    width: 100%;
    justify-content: space-between;
  }
  
  .section-header h2 {
    font-size: 1.5rem;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .modal-content {
    width: 95%;
    margin: 10px;
    border-radius: 12px;
    max-height: 95vh;
  }
  
  .modal-header {
    padding: 20px 25px;
  }
  
  .modal-header h3 {
    font-size: 1.3rem;
  }
  
  .modal-body {
    padding: 25px;
  }
  
  .form-row {
    gap: 15px;
    margin-bottom: 20px;
  }
  
  .table-cell {
    min-width: 100px;
    padding: 10px;
    font-size: 0.9rem;
  }
  
  .horizontal-table-container {
    font-size: 0.9rem;
  }
  
  .form-actions {
    margin-top: 25px;
    padding-top: 20px;
    flex-direction: column;
  }
  
  .form-actions .btn-primary,
  .form-actions .btn-secondary {
    width: 100%;
    margin-bottom: 10px;
  }
  
  .statistics-content {
    grid-template-columns: 1fr;
  }
  
  .stat-card {
    padding: 20px;
  }
  
  .stat-number {
    font-size: 2rem;
  }
}

@media (max-width: 480px) {
  .table-cell {
    min-width: 80px;
    padding: 8px;
    font-size: 0.8rem;
  }
  
  .section-header h2 {
    font-size: 1.3rem;
  }
  
  .btn-primary {
    padding: 10px 15px;
    font-size: 0.9rem;
  }
  
  .modal-content {
    width: 98%;
    margin: 5px;
  }
  
  .modal-header {
    padding: 15px 20px;
  }
  
  .modal-body {
    padding: 20px;
  }
  
  .form-group label {
    font-size: 0.9rem;
  }
  
  .form-group input,
  .form-group select,
  .form-group textarea {
    padding: 10px 12px;
    font-size: 0.95rem;
  }
  
  .datepicker-input {
    padding: 10px 12px;
    font-size: 0.95rem;
  }
  
  .menu-item {
    min-width: 100px;
    padding: 10px;
    font-size: 0.85rem;
  }
  
  .stat-number {
    font-size: 1.8rem;
  }
  
  .stat-card h3 {
    font-size: 1.1rem;
  }
}

/* ÂØºÂá∫ÊåâÈíÆÁªÑÊ†∑Âºè */
.export-buttons-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 25px 0 20px;
  padding: 20px;
  background: linear-gradient(135deg, white, #f8fafc);
  border-radius: 12px;
  box-shadow: var(--card-shadow);
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.export-buttons-info {
  display: flex;
  align-items: center;
}

.export-count-info {
  font-size: 1.1rem;
  font-weight: 600;
  color: #4a5568;
  background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
  padding: 12px 20px;
  border-radius: 10px;
  border: 1px solid #cbd5e0;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.export-buttons-group {
  display: flex;
  gap: 15px;
}

.btn-export {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  border: none;
  border-radius: 10px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  letter-spacing: 0.3px;
  min-width: 140px;
  justify-content: center;
}

.btn-export-selected {
  background: linear-gradient(135deg, #48bb78, #38a169);
  color: white;
  box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);
}

.btn-export-selected:hover {
  background: linear-gradient(135deg, #38a169, #2f855a);
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(72, 187, 120, 0.4);
}

.btn-export-full {
  background: linear-gradient(135deg, #4299e1, #3182ce);
  color: white;
  box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
}

.btn-export-full:hover {
  background: linear-gradient(135deg, #3182ce, #2c5282);
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(66, 153, 225, 0.4);
}

.btn-export:active {
  transform: translateY(-1px);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.btn-export::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.6s ease;
}

.btn-export:hover::before {
  left: 100%;
}

.btn-export:focus {
  outline: none;
  box-shadow: 0 0 0 4px rgba(66, 153, 225, 0.2);
}

/* ÂìçÂ∫îÂºèËÆæËÆ° - ÂØºÂá∫ÊåâÈíÆ */
@media (max-width: 768px) {
  .export-buttons-container {
    flex-direction: column;
    gap: 15px;
    margin: 20px 0 15px;
    padding: 15px;
  }
  
  .export-buttons-group {
    width: 100%;
    justify-content: center;
  }
  
  .btn-export {
    width: 100%;
    max-width: 200px;
    padding: 10px 20px;
    font-size: 0.95rem;
  }
  
  .export-count-info {
    font-size: 1rem;
    padding: 10px 16px;
  }
}

@media (max-width: 480px) {
  .export-buttons-container {
    margin: 15px 0;
    padding: 12px;
  }
  
  .btn-export {
    padding: 8px 16px;
    font-size: 0.9rem;
    min-width: 120px;
  }
  
  .export-count-info {
    font-size: 0.9rem;
    padding: 8px 12px;
  }
}
</style>
